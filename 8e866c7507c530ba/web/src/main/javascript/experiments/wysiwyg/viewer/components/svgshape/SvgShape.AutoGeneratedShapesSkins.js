/**
 * Created by eitanr on 11/4/14.
 */
/**
 * @class wysiwyg.viewer.components.svgshape.SvgShape
 */
define.experiment.component('wysiwyg.viewer.components.svgshape.SvgShape.AutoGeneratedShapesSkins', function (def, strategy) {
    /**@type core.managers.component.ComponentDefinition */

    def.traits(strategy.merge(['wysiwyg.common.components.traits.SvgShapeNameHelper']));

    def.methods({
        _mediaGalleryCallback: function (rawData) {
            this._fileName = rawData ? rawData.fileName : '';

            if (!this._isValidFileName(this._fileName)) {
                console.error('invalid shape data received from media gallery: ', rawData);
                return;
            }

            var compResources = this.resources.W,
                styleId = this.getStyle().getDataItem().get('id');

            compResources.Skins.getSkin(this._getSkinNameFromFileName(this._fileName), function (skin) {
                var skinParamMapper = compResources.Theme._styleCache[styleId];
                if (skinParamMapper) {
                    skinParamMapper.setSkin(skin);
                }
                _.defer(function () {
                    window.parent.W.Commands.executeCommand('WEditorCommands.UpdateEditedComponentPanel', {});
                });

            });

            this._logChangeMediaSuccess();
        },
        _getSkinNameFromFileName: strategy.remove(), //trait version is used instead
        _setSkin: strategy.remove()
    });
});