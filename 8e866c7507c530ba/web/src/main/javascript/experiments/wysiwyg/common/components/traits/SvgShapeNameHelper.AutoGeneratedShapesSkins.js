/**
 * Created by eitanr on 11/4/14.
 */
define.experiment.newClass('wysiwyg.common.components.traits.SvgShapeNameHelper.AutoGeneratedShapesSkins', function (def, strategy) {

    def.methods({
        _isValidFileName: function (fileName) {
            if (!fileName) {
                return false;
            }
            var isV1Shape = fileName.indexOf('_svgshape.v1.') !== -1 && fileName.lastIndexOf('.js') === fileName.length - 3;
            var isV2Shape = fileName.lastIndexOf('.svg') === fileName.length - 4;

            return isV1Shape || isV2Shape;
        },

        _getSkinNameFromFileName: function (fileName) {
            var regEx,
                partsArr,
                md5Hash,
                version,
                name,
                skinName;

            if (fileName.lastIndexOf('.svg') === fileName.length - 4) { //v2
                //Example fileName: shapes/083ab0e246b24019a44c3d1e7096147f.svg
                //Example skinName: svgshape.v2.Svg_083ab0e246b24019a44c3d1e7096147f
                regEx = /^shapes\/([a-z0-9]{32})\.svg$/i;
                partsArr = regEx.exec(fileName);
                md5Hash = partsArr[1];
                skinName = 'svgshape.v2.Svg_' + md5Hash;
            } else { //v1
                //Example fileName: shapes/1d23a4adcc180e6168c9eb24b62ae238_svgshape.v1.CartIcon.js
                //Example skinName: svgshape.v1.svg_1d23a4adcc180e6168c9eb24b62ae238.CartIcon
                regEx = /^shapes\/([a-z0-9]{32})_svgshape\.(v\d)\.([A-Z][A-Za-z0-9_]*)\.js$/i;
                partsArr = regEx.exec(fileName);
                md5Hash = partsArr[1];
                version = partsArr[2];
                name = partsArr[3];
                skinName = ['svgshape', version, 'svg_' + md5Hash, name].join('.');
            }
            return skinName;
        }
    });
});