integration.noAutomation();

testRequire().classes('wysiwyg.deployment.JasmineEditorHelper');
testRequire().classes('wysiwyg.deployment.it.editor.MobileEditorUIDriver');
testRequire().classes('wysiwyg.deployment.it.editor.StructureComparisonDriver');

describe("Merge Algorithm Test:", function () {

    beforeEach(function () {
        window.editor = window.editor || new this.JasmineEditorHelper();
        window.mobileEditorUIDriver = window.mobileEditorUIDriver || new this.MobileEditorUIDriver();
        window.structureComparisonDriver = window.structureComparisonDriver || new this.StructureComparisonDriver();
        window.structureComparisonDriver.setAlertWhenTestFails(false);
        this.testConfigParams = {};
        document.title = "Merge Algorithm Test";

//        waitsFor(function () {
//            return editor.isReady();
//        }, 'editor to finish loading', 10000);
    });

    describe("Integration Tests", function () {
        beforeEach(function () {
            if (this.testConfigParams.debugAfterEndOfTest) {
                this.testConfigParams.debugAfterEndOfTest = false;
            }

            //delete all components in page:
            window.mobileEditorUIDriver.switchToDesktopEditor();
            window.mobileEditorUIDriver.deleteAllCurrentPageComponents();
            window.mobileEditorUIDriver.deleteHeaderAndFooterComponents();

            window.mobileEditorUIDriver.switchToMobileEditor(function () {

                window.mobileEditorUIDriver.switchToDesktopEditor();

                //add components to page and regenerate mobile structure:
                var componentsToAddStringified = '[{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht0-mu","styleId":"wp3","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":550,"y":440,"width":100,"height":135,"scale":1,"anchors":[{"type":"BOTTOM_PARENT","targetComponent":"mainPage","locked":false,"distance":110,"topToTop":440,"originalValue":685}]},"data":{"type":"Image","uri":"d402a66125a3c08333fe02017ca33b48.jpg","title":"Tattooed Couple","description":"","width":800,"height":800,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null,"href":""},"dataRefs":{},"dataId":"c1h7x","props":{"type":"WPhotoProperties","displayMode":"fill","metaData":{}},"propsId":"c1bvk"},{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht3-8wv","styleId":"wp3","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":375,"y":435,"width":100,"height":135,"scale":1,"anchors":[{"type":"BOTTOM_PARENT","targetComponent":"mainPage","locked":false,"distance":115,"topToTop":435,"originalValue":685}]},"data":{"type":"Image","uri":"42c00842d85f7255737bc7583141da8c.jpg","title":"Golfing","description":"","width":400,"height":267,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null,"href":""},"dataRefs":{},"dataId":"c8w9","props":{"type":"WPhotoProperties","displayMode":"fill","metaData":{}},"propsId":"c1nls"},{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht2-o8d","styleId":"wp3","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":160,"y":435,"width":100,"height":135,"scale":1,"anchors":[{"type":"BOTTOM_PARENT","targetComponent":"mainPage","locked":false,"distance":115,"topToTop":435,"originalValue":685}]},"data":{"type":"Image","uri":"34d8a95205665efcd696d7328fcc8dd1.jpg","title":"Smiling Kids","description":"","width":1000,"height":987,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null,"href":""},"dataRefs":{},"dataId":"c13rc","props":{"type":"WPhotoProperties","displayMode":"fill","metaData":{}},"propsId":"cnly"},{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht2-1dvb","styleId":"wp3","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":150,"y":310,"width":165,"height":70,"scale":1,"anchors":[{"type":"BOTTOM_TOP","targetComponent":"WPht2-o8d","locked":true,"distance":55,"topToTop":125,"originalValue":435}]},"data":{"type":"Image","uri":"a9310f3018ceccaa4aaaed365e78f42d.jpg","title":"iPad","description":"","width":735,"height":314,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null,"href":""},"dataRefs":{},"dataId":"ctau","props":{"type":"WPhotoProperties","displayMode":"fill","metaData":{}},"propsId":"c16y2"},{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht1-13z5","styleId":"wp3","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":70,"y":240,"width":195,"height":120,"scale":1,"anchors":[{"type":"BOTTOM_TOP","targetComponent":"WPht2-1dvb","locked":true,"distance":-50,"topToTop":70,"originalValue":310}]},"data":{"type":"Image","uri":"01b44225bee063a2c8a44896adaf2177.jpg","title":"Surfing","description":"","width":907,"height":605,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null,"href":""},"dataRefs":{},"dataId":"c24u5","props":{"type":"WPhotoProperties","displayMode":"fill","metaData":{}},"propsId":"csze"},{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht1-e57","styleId":"wp2","skin":"wysiwyg.viewer.skins.photo.NoSkinPhoto","layout":{"x":430,"y":85,"width":400,"height":90,"scale":1,"anchors":[{"type":"BOTTOM_TOP","targetComponent":"WPht3-8wv","locked":false,"distance":260,"topToTop":350,"originalValue":435},{"type":"BOTTOM_TOP","targetComponent":"WPht0-mu","locked":false,"distance":265,"topToTop":355,"originalValue":440}]},"data":{"type":"Image","uri":"7429e40b460d05ee4f3aeae30e13b52f.jpg","title":"Blue Hummingbird","description":"","width":785,"height":523,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null,"href":""},"dataRefs":{},"dataId":"c20lv","props":{"type":"WPhotoProperties","displayMode":"fill","metaData":{}},"propsId":"WPht1-e57"},{"componentType":"wysiwyg.viewer.components.SlideShowGallery","type":"Component","id":"SldShwGllry0-hsf","styleId":"ssg1","skin":"wysiwyg.viewer.skins.gallery.SlideShowTextOverlay","layout":{"x":40,"y":15,"width":310,"height":190,"scale":1,"anchors":[{"type":"BOTTOM_TOP","targetComponent":"WPht1-13z5","locked":true,"distance":35,"topToTop":225,"originalValue":240}]},"data":{"type":"ImageList","metaData":{"isPreset":false}},"dataRefs":{"items":{"isList":true,"items":[{"data":{"description":"","height":1280,"title":"Vintage Chair","uri":"6f90862346f6d03bc7e8941fec94b13a.jpg","width":850,"mediaType":"picture","type":"Image","linkType":"FREE_LINK","id":"imaged4s","metaData":{"isPreset":false},"href":"","target":"","alt":"","originalImageDataRef":null},"dataRefs":{}}]}},"dataId":"c20gy","props":{"type":"SlideShowGalleryProperties","imageMode":"clipImage","transition":"swipeHorizontal","autoplayInterval":"5","transDuration":1,"bidirectional":true,"showAutoplay":true,"showNavigation":true,"showCounter":true,"expandEnabled":true,"goToLinkText":"Go to link","galleryImageOnClickAction":"zoomMode","metaData":{"isPreset":false},"autoplay":false,"reverse":false},"propsId":"SldShwGllry0-hsf"}]';
                window.mobileEditorUIDriver.addComponentsToPage(componentsToAddStringified, function () {

                    var curPageNode = W.Preview.getPreviewManagers().Viewer.getCurrentPageNode();
                    var curPageComponents = curPageNode.getLogic().getChildren().map(function (node) {
                        return node.getLogic();
                    });
//                    window.mobileEditorUIDriver.sleep(250, function(){
                    W.Preview.getPreviewManagers().Layout.enforceAnchors(curPageComponents);
                    window.mobileEditorUIDriver.sleep(500, function () {
                        window.mobileEditorUIDriver.switchToMobileEditor(function () {

                            window.mobileEditorUIDriver.regenerateWholeMobileStructureLayout(function () {
                                window.mobileEditorUIDriver.switchToDesktopEditor();
                            });
                        });
                    });
//                    });
                });
            });
        });

        //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
        //$$$$$$$$$$$$$$$$$$$$$   M O N E Y    S E C T I O N   $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
        //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

        describe("Layout modification of component in desktop", function () {

            //PASS
            it("+ changing component layout in desktop should not affect mobile layout", function () {
                window.mobileEditorUIDriver.switchToMobileEditor(function () {
                    var mobileSiteDataBeforeLayoutChange = window.structureComparisonDriver.parseAllTemplateRequiredDataForTest();
                    window.mobileEditorUIDriver.switchToDesktopEditor();
                    window.mobileEditorUIDriver.moveResizeComponent("SldShwGllry0-hsf", {width: 50, height: 50, x: 50, y: 50, updateLayout: true});
                    window.mobileEditorUIDriver.switchToMobileEditor(function () {
                        var mobileSiteDataAfterLayoutChange = window.structureComparisonDriver.parseAllTemplateRequiredDataForTest();
                        expect(mobileSiteDataBeforeLayoutChange).toBe(mobileSiteDataAfterLayoutChange);
                    });
                });

            });
        });

        describe("Component Deletion: delete component(s) in the desktop editor, and test that mobileEditor applies: component is deleted, and the gap is updated", function () {


            //PASS
            it('+ top component is deleted (should shrink gap)', function () {
                window.mobileEditorUIDriver.deleteComponent('SldShwGllry0-hsf');

                window.mobileEditorUIDriver.switchToMobileEditor(function () {
                    var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","WPht1-e57","WPht2-1dvb","WPht1-13z5","WPht2-o8d","WPht3-8wv","WPht0-mu"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---WPht1-e57,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht2-o8d,&@slashn---WPht3-8wv,&@slashn---WPht0-mu&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:553}&@slashn---WPht1-e57:{x:20,y:10,width:280,height:63}&@slashn---WPht2-1dvb:{x:111,y:163,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:83,width:223,height:137}&@slashn---WPht2-o8d:{x:47,y:253,width:100,height:135}&@slashn---WPht3-8wv:{x:174,y:253,width:100,height:135}&@slashn---WPht0-mu:{x:110,y:398,width:100,height:135}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:670,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:553}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:553}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:83,targetComponent:WPht1-13z5,topToTop:73,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:10,locked:true,originalValue:253,targetComponent:WPht2-o8d,topToTop:90,type:BOTTOM_TOP}&@slashn{distance:10,locked:true,originalValue:253,targetComponent:WPht3-8wv,topToTop:90,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:163,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-o8d:[&@slashn{distance:10,locked:true,originalValue:398,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht3-8wv:[&@slashn{distance:10,locked:true,originalValue:398,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-mu:[&@slashn{distance:202,locked:false,originalValue:735,targetComponent:mainPage,topToTop:398,type:BOTTOM_PARENT}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                    window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);
                });
            }); //it

            //PASS
            it('+ middle component with a component near it, is deleted (should not shrink gap)', function () {
                window.mobileEditorUIDriver.deleteComponent('WPht2-o8d');
                window.mobileEditorUIDriver.switchToMobileEditor(function () {
                    var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","SldShwGllry0-hsf","WPht1-e57","WPht2-1dvb","WPht1-13z5","WPht3-8wv","WPht0-mu"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---SldShwGllry0-hsf,&@slashn---WPht1-e57,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht3-8wv,&@slashn---WPht0-mu&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:735}&@slashn---SldShwGllry0-hsf:{x:20,y:10,width:280,height:172}&@slashn---WPht1-e57:{x:20,y:192,width:280,height:63}&@slashn---WPht2-1dvb:{x:111,y:345,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:265,width:223,height:137}&@slashn---WPht3-8wv:{x:174,y:435,width:100,height:135}&@slashn---WPht0-mu:{x:110,y:580,width:100,height:135}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:852,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:735}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:735}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---SldShwGllry0-hsf:[&@slashn{distance:10,locked:true,originalValue:192,targetComponent:WPht1-e57,topToTop:182,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:265,targetComponent:WPht1-13z5,topToTop:73,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:10,locked:true,originalValue:435,targetComponent:WPht3-8wv,topToTop:90,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:345,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht3-8wv:[&@slashn{distance:10,locked:true,originalValue:580,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-mu:[&@slashn{distance:10,locked:true,originalValue:725,targetComponent:mainPage,topToTop:580,type:BOTTOM_PARENT}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                    window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);
                });
            }); //it

            //PASS
            it('+ two components forming a block are deleted (should shrink gap)', function () {
                window.mobileEditorUIDriver.deleteComponent('WPht2-o8d');
                window.mobileEditorUIDriver.deleteComponent("WPht3-8wv");

                window.mobileEditorUIDriver.switchToMobileEditor(function () {
                    var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","SldShwGllry0-hsf","WPht1-e57","WPht2-1dvb","WPht1-13z5","WPht0-mu"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---SldShwGllry0-hsf,&@slashn---WPht1-e57,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht0-mu&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:590}&@slashn---SldShwGllry0-hsf:{x:20,y:10,width:280,height:172}&@slashn---WPht1-e57:{x:20,y:192,width:280,height:63}&@slashn---WPht2-1dvb:{x:111,y:345,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:265,width:223,height:137}&@slashn---WPht0-mu:{x:110,y:435,width:100,height:135}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:707,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:590}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:590}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---SldShwGllry0-hsf:[&@slashn{distance:10,locked:true,originalValue:192,targetComponent:WPht1-e57,topToTop:182,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:265,targetComponent:WPht1-13z5,topToTop:73,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:10,locked:true,originalValue:435,targetComponent:WPht0-mu,topToTop:90,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:345,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-mu:[&@slashn{distance:165,locked:false,originalValue:735,targetComponent:mainPage,topToTop:435,type:BOTTOM_PARENT}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                    window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);

                });
            }); //it

            //PASS
            it('+ bottom component is deleted (should shrink gap)', function () {
                window.mobileEditorUIDriver.deleteComponent('WPht0-mu');

                window.mobileEditorUIDriver.switchToMobileEditor(function () {
                    var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","SldShwGllry0-hsf","WPht1-e57","WPht2-1dvb","WPht1-13z5","WPht2-o8d","WPht3-8wv"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---SldShwGllry0-hsf,&@slashn---WPht1-e57,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht2-o8d,&@slashn---WPht3-8wv&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:590}&@slashn---SldShwGllry0-hsf:{x:20,y:10,width:280,height:172}&@slashn---WPht1-e57:{x:20,y:192,width:280,height:63}&@slashn---WPht2-1dvb:{x:111,y:345,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:265,width:223,height:137}&@slashn---WPht2-o8d:{x:47,y:435,width:100,height:135}&@slashn---WPht3-8wv:{x:174,y:435,width:100,height:135}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:707,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:590}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:590}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---SldShwGllry0-hsf:[&@slashn{distance:10,locked:true,originalValue:192,targetComponent:WPht1-e57,topToTop:182,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:265,targetComponent:WPht1-13z5,topToTop:73,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:10,locked:true,originalValue:435,targetComponent:WPht2-o8d,topToTop:90,type:BOTTOM_TOP}&@slashn{distance:10,locked:true,originalValue:435,targetComponent:WPht3-8wv,topToTop:90,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:345,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-o8d:[&@slashn{distance:10,locked:true,originalValue:580,targetComponent:mainPage,topToTop:435,type:BOTTOM_PARENT}&@slashn]&@slashn---WPht3-8wv:[&@slashn{distance:10,locked:true,originalValue:580,targetComponent:mainPage,topToTop:435,type:BOTTOM_PARENT}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                    window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);
                });
            }); //it

            //PASS
            it('+ top and bottom component are deleted (should shrink gap)', function () {
                window.mobileEditorUIDriver.deleteComponent('SldShwGllry0-hsf');
                window.mobileEditorUIDriver.deleteComponent('WPht0-mu');

                window.mobileEditorUIDriver.switchToMobileEditor(function () {
                    var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","WPht1-e57","WPht2-1dvb","WPht1-13z5","WPht2-o8d","WPht3-8wv"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---WPht1-e57,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht2-o8d,&@slashn---WPht3-8wv&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:408}&@slashn---WPht1-e57:{x:20,y:10,width:280,height:63}&@slashn---WPht2-1dvb:{x:111,y:163,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:83,width:223,height:137}&@slashn---WPht2-o8d:{x:47,y:253,width:100,height:135}&@slashn---WPht3-8wv:{x:174,y:253,width:100,height:135}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:525,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:408}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:408}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:83,targetComponent:WPht1-13z5,topToTop:73,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:10,locked:true,originalValue:253,targetComponent:WPht2-o8d,topToTop:90,type:BOTTOM_TOP}&@slashn{distance:10,locked:true,originalValue:253,targetComponent:WPht3-8wv,topToTop:90,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:163,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-o8d:[&@slashn{distance:10,locked:true,originalValue:398,targetComponent:mainPage,topToTop:253,type:BOTTOM_PARENT}&@slashn]&@slashn---WPht3-8wv:[&@slashn{distance:10,locked:true,originalValue:398,targetComponent:mainPage,topToTop:253,type:BOTTOM_PARENT}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                });
            }); //it

            //PASS
            it('+ lower component of composition group is deleted (should shrink gap)', function () {
                window.mobileEditorUIDriver.deleteComponent('WPht2-1dvb');

                window.mobileEditorUIDriver.switchToMobileEditor(function () {
                    var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","SldShwGllry0-hsf","WPht1-e57","WPht1-13z5","WPht2-o8d","WPht3-8wv","WPht0-mu"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---SldShwGllry0-hsf,&@slashn---WPht1-e57,&@slashn---WPht1-13z5,&@slashn---WPht2-o8d,&@slashn---WPht3-8wv,&@slashn---WPht0-mu&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:712}&@slashn---SldShwGllry0-hsf:{x:20,y:10,width:280,height:172}&@slashn---WPht1-e57:{x:20,y:192,width:280,height:63}&@slashn---WPht1-13z5:{x:20,y:265,width:223,height:137}&@slashn---WPht2-o8d:{x:47,y:412,width:100,height:135}&@slashn---WPht3-8wv:{x:174,y:412,width:100,height:135}&@slashn---WPht0-mu:{x:110,y:557,width:100,height:135}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:829,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:712}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:712}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---SldShwGllry0-hsf:[&@slashn{distance:10,locked:true,originalValue:192,targetComponent:WPht1-e57,topToTop:182,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:265,targetComponent:WPht1-13z5,topToTop:73,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:10,locked:true,originalValue:412,targetComponent:WPht2-o8d,topToTop:147,type:BOTTOM_TOP}&@slashn{distance:10,locked:true,originalValue:412,targetComponent:WPht3-8wv,topToTop:147,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-o8d:[&@slashn{distance:10,locked:true,originalValue:557,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht3-8wv:[&@slashn{distance:10,locked:true,originalValue:557,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-mu:[&@slashn{distance:43,locked:true,originalValue:735,targetComponent:mainPage,topToTop:557,type:BOTTOM_PARENT}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                    window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);
                });
            }); //it


            // PASS
            it('+ when two mobile components are side to side, and the higher one is deleted in the desktop, the merge shoudlnt leave a gap', function () {
                window.mobileEditorUIDriver.switchToMobileEditor(function () {
                    window.mobileEditorUIDriver.moveResizeComponent("SldShwGllry0-hsf", {width: 50, updateLayout: true});
                    window.mobileEditorUIDriver.moveResizeComponent("WPht1-e57", {width: 50, x: 100, y: 10, updateLayout: true});
                    window.mobileEditorUIDriver.switchToDesktopEditor();
                    window.mobileEditorUIDriver.deleteComponent('SldShwGllry0-hsf');

                    window.mobileEditorUIDriver.switchToMobileEditor(function () {
                        var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","WPht1-e57","WPht2-1dvb","WPht1-13z5","WPht2-o8d","WPht3-8wv","WPht0-mu"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---WPht1-e57,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht2-o8d,&@slashn---WPht3-8wv,&@slashn---WPht0-mu&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:626}&@slashn---WPht1-e57:{x:100,y:10,width:50,height:63}&@slashn---WPht2-1dvb:{x:111,y:236,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:156,width:223,height:137}&@slashn---WPht2-o8d:{x:47,y:326,width:100,height:135}&@slashn---WPht3-8wv:{x:174,y:326,width:100,height:135}&@slashn---WPht0-mu:{x:110,y:471,width:100,height:135}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:743,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:626}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:626}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:83,locked:false,originalValue:156,targetComponent:WPht1-13z5,topToTop:146,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:10,locked:true,originalValue:326,targetComponent:WPht2-o8d,topToTop:90,type:BOTTOM_TOP}&@slashn{distance:10,locked:true,originalValue:326,targetComponent:WPht3-8wv,topToTop:90,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:236,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-o8d:[&@slashn{distance:10,locked:true,originalValue:471,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht3-8wv:[&@slashn{distance:10,locked:true,originalValue:471,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-mu:[&@slashn{distance:129,locked:false,originalValue:735,targetComponent:mainPage,topToTop:471,type:BOTTOM_PARENT}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';

                        window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);
                    });
                });
            }); //it


            //PASS
            it('+ upper component of composition group is deleted (should shrink gap)', function () {

                window.mobileEditorUIDriver.deleteComponent('WPht1-13z5');

                window.mobileEditorUIDriver.switchToMobileEditor(function () {
                    var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","SldShwGllry0-hsf","WPht1-e57","WPht2-1dvb","WPht2-o8d","WPht3-8wv","WPht0-mu"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---SldShwGllry0-hsf,&@slashn---WPht1-e57,&@slashn---WPht2-1dvb,&@slashn---WPht2-o8d,&@slashn---WPht3-8wv,&@slashn---WPht0-mu&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:655}&@slashn---SldShwGllry0-hsf:{x:20,y:10,width:280,height:172}&@slashn---WPht1-e57:{x:20,y:192,width:280,height:63}&@slashn---WPht2-1dvb:{x:111,y:265,width:189,height:80}&@slashn---WPht2-o8d:{x:47,y:355,width:100,height:135}&@slashn---WPht3-8wv:{x:174,y:355,width:100,height:135}&@slashn---WPht0-mu:{x:110,y:500,width:100,height:135}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:772,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:655}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:655}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---SldShwGllry0-hsf:[&@slashn{distance:10,locked:true,originalValue:192,targetComponent:WPht1-e57,topToTop:182,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:265,targetComponent:WPht2-1dvb,topToTop:73,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:10,locked:true,originalValue:355,targetComponent:WPht2-o8d,topToTop:90,type:BOTTOM_TOP}&@slashn{distance:10,locked:true,originalValue:355,targetComponent:WPht3-8wv,topToTop:90,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-o8d:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht3-8wv:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-mu:[&@slashn{distance:100,locked:false,originalValue:735,targetComponent:mainPage,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                    window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);
                });
            }); //it


        }); //describe component deletion

        describe("Component Addition: add component(s) in the desktop editor, and test that mobileEditor applies:", function () {

            describe("passing test", function () {

                describe("addition of a single component", function () {

                    //PASS
                    it('+ component is added to the top of the page', function () {
                        window.mobileEditorUIDriver.selectAllPageComponents();
                        window.mobileEditorUIDriver.moveResizeComponent("SELECTED_COMPONENT", {y: 250, enforceAnchors: true});

                        var componentsToAddStringified = '[{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht0-1bbo","styleId":"wp1","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":320,"y":30,"width":400,"height":65,"scale":1,"anchors":[{"type":"BOTTOM_TOP","targetComponent":"SldShwGllry0-hsf","locked":true,"distance":50,"topToTop":115,"originalValue":145},{"type":"BOTTOM_TOP","targetComponent":"WPht1-e57","locked":false,"distance":120,"topToTop":185,"originalValue":215}]},"data":{"type":"Image","uri":"da9ed5_c23622c8b2a1eab837f3e10aee99a941.jpg","title":"Wide_wall.jpg","description":"","width":2560,"height":1024,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null,"href":""},"dataRefs":{},"dataId":"c11we","props":{"type":"WPhotoProperties","displayMode":"fill"},"propsId":"WPht0-1bbo"}]';
                        window.mobileEditorUIDriver.addComponentsToPage(componentsToAddStringified, function () {
                            window.mobileEditorUIDriver.moveResizeComponent("SELECTED_COMPONENT", {x: 30, updateLayout: true});

                            window.mobileEditorUIDriver.switchToMobileEditor(function () {
                                window.mobileEditorUIDriver.sleep(500, function () {
                                    var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","SldShwGllry0-hsf","WPht1-e57","WPht2-1dvb","WPht1-13z5","WPht2-o8d","WPht3-8wv","WPht0-mu","WPht0-1bbo"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---SldShwGllry0-hsf,&@slashn---WPht1-e57,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht2-o8d,&@slashn---WPht3-8wv,&@slashn---WPht0-mu,&@slashn---WPht0-1bbo&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:791}&@slashn---SldShwGllry0-hsf:{x:20,y:66,width:280,height:172}&@slashn---WPht1-e57:{x:20,y:248,width:280,height:63}&@slashn---WPht2-1dvb:{x:111,y:401,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:321,width:223,height:137}&@slashn---WPht2-o8d:{x:47,y:491,width:100,height:135}&@slashn---WPht3-8wv:{x:174,y:491,width:100,height:135}&@slashn---WPht0-mu:{x:110,y:636,width:100,height:135}&@slashn---WPht0-1bbo:{x:20,y:10,width:280,height:46}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:908,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:791}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:791}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---SldShwGllry0-hsf:[&@slashn{distance:10,locked:true,originalValue:248,targetComponent:WPht1-e57,topToTop:182,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:321,targetComponent:WPht1-13z5,topToTop:73,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:10,locked:true,originalValue:491,targetComponent:WPht2-o8d,topToTop:90,type:BOTTOM_TOP}&@slashn{distance:10,locked:true,originalValue:491,targetComponent:WPht3-8wv,topToTop:90,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:401,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-o8d:[&@slashn{distance:10,locked:true,originalValue:636,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht3-8wv:[&@slashn{distance:10,locked:true,originalValue:636,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-mu:[&@slashn{distance:0,locked:true,originalValue:771,targetComponent:mainPage,topToTop:636,type:BOTTOM_PARENT}&@slashn]&@slashn---WPht0-1bbo:[&@slashn{distance:10,locked:true,originalValue:66,targetComponent:SldShwGllry0-hsf,topToTop:56,type:BOTTOM_TOP}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';

                                    window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);

                                });
                            });
                        });
                    }); //it

                    //PASS
                    it('+ component is added between two components', function () {
                        window.mobileEditorUIDriver.moveResizeComponent("WPht1-e57", {x: 900, enforceAnchors: true});

                        var componentsToAddStringified = '[{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht0-1bbo","styleId":"wp1","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":320,"y":30,"width":400,"height":65,"scale":1,"anchors":[{"type":"BOTTOM_TOP","targetComponent":"SldShwGllry0-hsf","locked":true,"distance":50,"topToTop":115,"originalValue":145},{"type":"BOTTOM_TOP","targetComponent":"WPht1-e57","locked":false,"distance":120,"topToTop":185,"originalValue":215}]},"data":{"type":"Image","uri":"da9ed5_c23622c8b2a1eab837f3e10aee99a941.jpg","title":"Wide_wall.jpg","description":"","width":2560,"height":1024,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null,"href":""},"dataRefs":{},"dataId":"c11we","props":{"type":"WPhotoProperties","displayMode":"fill"},"propsId":"WPht0-1bbo"}]';
                        window.mobileEditorUIDriver.addComponentsToPage(componentsToAddStringified, function () {
                            window.mobileEditorUIDriver.moveResizeComponent("SELECTED_COMPONENT", {x: 420, y: 90, updateLayout: true});

                            window.mobileEditorUIDriver.switchToMobileEditor(function () {
                                var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","SldShwGllry0-hsf","WPht1-e57","WPht2-1dvb","WPht1-13z5","WPht2-o8d","WPht3-8wv","WPht0-mu","WPht0-1bbo"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---SldShwGllry0-hsf,&@slashn---WPht1-e57,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht2-o8d,&@slashn---WPht3-8wv,&@slashn---WPht0-mu,&@slashn---WPht0-1bbo&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:791}&@slashn---SldShwGllry0-hsf:{x:20,y:10,width:280,height:172}&@slashn---WPht1-e57:{x:20,y:248,width:280,height:63}&@slashn---WPht2-1dvb:{x:111,y:401,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:321,width:223,height:137}&@slashn---WPht2-o8d:{x:47,y:491,width:100,height:135}&@slashn---WPht3-8wv:{x:174,y:491,width:100,height:135}&@slashn---WPht0-mu:{x:110,y:636,width:100,height:135}&@slashn---WPht0-1bbo:{x:20,y:192,width:280,height:46}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:908,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:791}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:791}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---SldShwGllry0-hsf:[&@slashn{distance:10,locked:true,originalValue:192,targetComponent:WPht0-1bbo,topToTop:182,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:321,targetComponent:WPht1-13z5,topToTop:73,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:10,locked:true,originalValue:491,targetComponent:WPht2-o8d,topToTop:90,type:BOTTOM_TOP}&@slashn{distance:10,locked:true,originalValue:491,targetComponent:WPht3-8wv,topToTop:90,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:401,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-o8d:[&@slashn{distance:10,locked:true,originalValue:636,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht3-8wv:[&@slashn{distance:10,locked:true,originalValue:636,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-mu:[&@slashn{distance:0,locked:true,originalValue:771,targetComponent:mainPage,topToTop:636,type:BOTTOM_PARENT}&@slashn]&@slashn---WPht0-1bbo:[&@slashn{distance:10,locked:true,originalValue:248,targetComponent:WPht1-e57,topToTop:56,type:BOTTOM_TOP}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';

                                window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);

                            });
                        });
                    }); //it

                    //PASS
                    it('+ thin component, width=50px (should not get page width)', function () {
                        window.mobileEditorUIDriver.moveResizeComponent("WPht1-e57", {x: 900, enforceAnchors: true});

                        var componentsToAddStringified = '[{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht0-1bbo","styleId":"wp1","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":320,"y":30,"width":400,"height":65,"scale":1,"anchors":[{"type":"BOTTOM_TOP","targetComponent":"SldShwGllry0-hsf","locked":true,"distance":50,"topToTop":115,"originalValue":145},{"type":"BOTTOM_TOP","targetComponent":"WPht1-e57","locked":false,"distance":120,"topToTop":185,"originalValue":215}]},"data":{"type":"Image","uri":"da9ed5_c23622c8b2a1eab837f3e10aee99a941.jpg","title":"Wide_wall.jpg","description":"","width":2560,"height":1024,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null,"href":""},"dataRefs":{},"dataId":"c11we","props":{"type":"WPhotoProperties","displayMode":"fill"},"propsId":"WPht0-1bbo"}]';
                        window.mobileEditorUIDriver.addComponentsToPage(componentsToAddStringified, function () {
                            window.mobileEditorUIDriver.moveResizeComponent("SELECTED_COMPONENT", {width: 50, x: 420, y: 90, updateLayout: true});


                            window.mobileEditorUIDriver.switchToMobileEditor(function () {
                                var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","SldShwGllry0-hsf","WPht1-e57","WPht2-1dvb","WPht1-13z5","WPht2-o8d","WPht3-8wv","WPht0-mu","WPht0-1bbo"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---SldShwGllry0-hsf,&@slashn---WPht1-e57,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht2-o8d,&@slashn---WPht3-8wv,&@slashn---WPht0-mu,&@slashn---WPht0-1bbo&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:810}&@slashn---SldShwGllry0-hsf:{x:20,y:10,width:280,height:172}&@slashn---WPht1-e57:{x:20,y:267,width:280,height:63}&@slashn---WPht2-1dvb:{x:111,y:420,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:340,width:223,height:137}&@slashn---WPht2-o8d:{x:47,y:510,width:100,height:135}&@slashn---WPht3-8wv:{x:174,y:510,width:100,height:135}&@slashn---WPht0-mu:{x:110,y:655,width:100,height:135}&@slashn---WPht0-1bbo:{x:135,y:192,width:50,height:65}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:927,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:810}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:810}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---SldShwGllry0-hsf:[&@slashn{distance:10,locked:true,originalValue:192,targetComponent:WPht0-1bbo,topToTop:182,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:340,targetComponent:WPht1-13z5,topToTop:73,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:10,locked:true,originalValue:510,targetComponent:WPht2-o8d,topToTop:90,type:BOTTOM_TOP}&@slashn{distance:10,locked:true,originalValue:510,targetComponent:WPht3-8wv,topToTop:90,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:420,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-o8d:[&@slashn{distance:10,locked:true,originalValue:655,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht3-8wv:[&@slashn{distance:10,locked:true,originalValue:655,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-mu:[&@slashn{distance:0,locked:true,originalValue:790,targetComponent:mainPage,topToTop:655,type:BOTTOM_PARENT}&@slashn]&@slashn---WPht0-1bbo:[&@slashn{distance:10,locked:true,originalValue:267,targetComponent:WPht1-e57,topToTop:75,type:BOTTOM_TOP}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';

                                window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);

                            });
                        });
                    }); //it

                    //PASS
                    it('+ thin component, width=200px (should get page width)', function () {
                        window.mobileEditorUIDriver.moveResizeComponent("WPht1-e57", {x: 900, enforceAnchors: true});

                        var componentsToAddStringified = '[{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht0-1bbo","styleId":"wp1","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":320,"y":30,"width":400,"height":65,"scale":1,"anchors":[{"type":"BOTTOM_TOP","targetComponent":"SldShwGllry0-hsf","locked":true,"distance":50,"topToTop":115,"originalValue":145},{"type":"BOTTOM_TOP","targetComponent":"WPht1-e57","locked":false,"distance":120,"topToTop":185,"originalValue":215}]},"data":{"type":"Image","uri":"da9ed5_c23622c8b2a1eab837f3e10aee99a941.jpg","title":"Wide_wall.jpg","description":"","width":2560,"height":1024,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null,"href":""},"dataRefs":{},"dataId":"c11we","props":{"type":"WPhotoProperties","displayMode":"fill"},"propsId":"WPht0-1bbo"}]';
                        window.mobileEditorUIDriver.addComponentsToPage(componentsToAddStringified, function () {
                            window.mobileEditorUIDriver.moveResizeComponent("SELECTED_COMPONENT", {width: 200, x: 420, y: 90, updateLayout: true});


                            window.mobileEditorUIDriver.switchToMobileEditor(function () {
                                var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","SldShwGllry0-hsf","WPht1-e57","WPht2-1dvb","WPht1-13z5","WPht2-o8d","WPht3-8wv","WPht0-mu","WPht0-1bbo"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---SldShwGllry0-hsf,&@slashn---WPht1-e57,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht2-o8d,&@slashn---WPht3-8wv,&@slashn---WPht0-mu,&@slashn---WPht0-1bbo&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:836}&@slashn---SldShwGllry0-hsf:{x:20,y:10,width:280,height:172}&@slashn---WPht1-e57:{x:20,y:293,width:280,height:63}&@slashn---WPht2-1dvb:{x:111,y:446,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:366,width:223,height:137}&@slashn---WPht2-o8d:{x:47,y:536,width:100,height:135}&@slashn---WPht3-8wv:{x:174,y:536,width:100,height:135}&@slashn---WPht0-mu:{x:110,y:681,width:100,height:135}&@slashn---WPht0-1bbo:{x:20,y:192,width:280,height:91}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:953,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:836}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:836}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---SldShwGllry0-hsf:[&@slashn{distance:10,locked:true,originalValue:192,targetComponent:WPht0-1bbo,topToTop:182,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:366,targetComponent:WPht1-13z5,topToTop:73,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:10,locked:true,originalValue:536,targetComponent:WPht2-o8d,topToTop:90,type:BOTTOM_TOP}&@slashn{distance:10,locked:true,originalValue:536,targetComponent:WPht3-8wv,topToTop:90,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:446,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-o8d:[&@slashn{distance:10,locked:true,originalValue:681,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht3-8wv:[&@slashn{distance:10,locked:true,originalValue:681,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-mu:[&@slashn{distance:0,locked:true,originalValue:816,targetComponent:mainPage,topToTop:681,type:BOTTOM_PARENT}&@slashn]&@slashn---WPht0-1bbo:[&@slashn{distance:10,locked:true,originalValue:293,targetComponent:WPht1-e57,topToTop:101,type:BOTTOM_TOP}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';

                                window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);
                            });
                        });
                    }); //it

                    //PASS
                    it('+ component is added to the top of the page, very near to the component below it (causing a locked anchor)', function () {
                        window.mobileEditorUIDriver.selectAllPageComponents();
                        window.mobileEditorUIDriver.moveResizeComponent("SELECTED_COMPONENT", {y: 160, enforceAnchors: true});


                        var componentsToAddStringified = '[{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht0-1bbo","styleId":"wp1","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":320,"y":30,"width":400,"height":65,"scale":1,"anchors":[{"type":"BOTTOM_TOP","targetComponent":"SldShwGllry0-hsf","locked":true,"distance":50,"topToTop":115,"originalValue":145},{"type":"BOTTOM_TOP","targetComponent":"WPht1-e57","locked":false,"distance":120,"topToTop":185,"originalValue":215}]},"data":{"type":"Image","uri":"da9ed5_c23622c8b2a1eab837f3e10aee99a941.jpg","title":"Wide_wall.jpg","description":"","width":2560,"height":1024,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null,"href":""},"dataRefs":{},"dataId":"c11we","props":{"type":"WPhotoProperties","displayMode":"fill"},"propsId":"WPht0-1bbo"}]';
                        window.mobileEditorUIDriver.addComponentsToPage(componentsToAddStringified, function () {
                            window.mobileEditorUIDriver.moveResizeComponent("SELECTED_COMPONENT", {x: 30, updateLayout: true});


                            window.mobileEditorUIDriver.switchToMobileEditor(function () {
                                var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","SldShwGllry0-hsf","WPht1-e57","WPht2-1dvb","WPht1-13z5","WPht2-o8d","WPht3-8wv","WPht0-mu","WPht0-1bbo"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---SldShwGllry0-hsf,&@slashn---WPht1-e57,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht2-o8d,&@slashn---WPht3-8wv,&@slashn---WPht0-mu,&@slashn---WPht0-1bbo&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:791}&@slashn---SldShwGllry0-hsf:{x:20,y:66,width:280,height:172}&@slashn---WPht1-e57:{x:20,y:248,width:280,height:63}&@slashn---WPht2-1dvb:{x:111,y:401,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:321,width:223,height:137}&@slashn---WPht2-o8d:{x:47,y:491,width:100,height:135}&@slashn---WPht3-8wv:{x:174,y:491,width:100,height:135}&@slashn---WPht0-mu:{x:110,y:636,width:100,height:135}&@slashn---WPht0-1bbo:{x:20,y:10,width:280,height:46}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:908,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:791}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:791}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---SldShwGllry0-hsf:[&@slashn{distance:10,locked:true,originalValue:248,targetComponent:WPht1-e57,topToTop:182,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:321,targetComponent:WPht1-13z5,topToTop:73,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:10,locked:true,originalValue:491,targetComponent:WPht2-o8d,topToTop:90,type:BOTTOM_TOP}&@slashn{distance:10,locked:true,originalValue:491,targetComponent:WPht3-8wv,topToTop:90,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:401,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-o8d:[&@slashn{distance:10,locked:true,originalValue:636,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht3-8wv:[&@slashn{distance:10,locked:true,originalValue:636,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-mu:[&@slashn{distance:0,locked:true,originalValue:771,targetComponent:mainPage,topToTop:636,type:BOTTOM_PARENT}&@slashn]&@slashn---WPht0-1bbo:[&@slashn{distance:10,locked:true,originalValue:66,targetComponent:SldShwGllry0-hsf,topToTop:56,type:BOTTOM_TOP}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                                window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);

                            });
                        });
                    }); //it

                    //PASS
                    it('+ component is added to the bottom of the page', function () {
                        var componentsToAddStringified = '[{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht0-1bbo","styleId":"wp1","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":320,"y":30,"width":400,"height":65,"scale":1,"anchors":[{"type":"BOTTOM_TOP","targetComponent":"SldShwGllry0-hsf","locked":true,"distance":50,"topToTop":115,"originalValue":145},{"type":"BOTTOM_TOP","targetComponent":"WPht1-e57","locked":false,"distance":120,"topToTop":185,"originalValue":215}]},"data":{"type":"Image","uri":"da9ed5_c23622c8b2a1eab837f3e10aee99a941.jpg","title":"Wide_wall.jpg","description":"","width":2560,"height":1024,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null,"href":""},"dataRefs":{},"dataId":"c11we","props":{"type":"WPhotoProperties","displayMode":"fill"},"propsId":"WPht0-1bbo"}]';
                        window.mobileEditorUIDriver.addComponentsToPage(componentsToAddStringified, function () {
                            window.mobileEditorUIDriver.moveResizeComponent("SELECTED_COMPONENT", {x: 200, y: 800, updateLayout: true});

                            window.mobileEditorUIDriver.switchToMobileEditor(function () {
                                var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","SldShwGllry0-hsf","WPht1-e57","WPht2-1dvb","WPht1-13z5","WPht2-o8d","WPht3-8wv","WPht0-mu","WPht0-1bbo"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---SldShwGllry0-hsf,&@slashn---WPht1-e57,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht2-o8d,&@slashn---WPht3-8wv,&@slashn---WPht0-mu,&@slashn---WPht0-1bbo&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:791}&@slashn---SldShwGllry0-hsf:{x:20,y:10,width:280,height:172}&@slashn---WPht1-e57:{x:20,y:192,width:280,height:63}&@slashn---WPht2-1dvb:{x:111,y:345,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:265,width:223,height:137}&@slashn---WPht2-o8d:{x:47,y:435,width:100,height:135}&@slashn---WPht3-8wv:{x:174,y:435,width:100,height:135}&@slashn---WPht0-mu:{x:110,y:580,width:100,height:135}&@slashn---WPht0-1bbo:{x:20,y:725,width:280,height:46}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:908,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:791}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:791}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---SldShwGllry0-hsf:[&@slashn{distance:10,locked:true,originalValue:192,targetComponent:WPht1-e57,topToTop:182,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:265,targetComponent:WPht1-13z5,topToTop:73,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:10,locked:true,originalValue:435,targetComponent:WPht2-o8d,topToTop:90,type:BOTTOM_TOP}&@slashn{distance:10,locked:true,originalValue:435,targetComponent:WPht3-8wv,topToTop:90,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:345,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-o8d:[&@slashn{distance:10,locked:true,originalValue:580,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht3-8wv:[&@slashn{distance:10,locked:true,originalValue:580,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-mu:[&@slashn{distance:10,locked:true,originalValue:725,targetComponent:WPht0-1bbo,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-1bbo:[&@slashn{distance:0,locked:true,originalValue:771,targetComponent:mainPage,topToTop:725,type:BOTTOM_PARENT}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                                window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);

                            });
                        });
                    }); //it

                    //PASS
                    it('+ component is added to the bottom of the page, very near to the component above it (causing a locked anchor)', function () {
                        var componentsToAddStringified = '[{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht0-1bbo","styleId":"wp1","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":320,"y":30,"width":400,"height":65,"scale":1,"anchors":[{"type":"BOTTOM_TOP","targetComponent":"SldShwGllry0-hsf","locked":true,"distance":50,"topToTop":115,"originalValue":145},{"type":"BOTTOM_TOP","targetComponent":"WPht1-e57","locked":false,"distance":120,"topToTop":185,"originalValue":215}]},"data":{"type":"Image","uri":"da9ed5_c23622c8b2a1eab837f3e10aee99a941.jpg","title":"Wide_wall.jpg","description":"","width":2560,"height":1024,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null,"href":""},"dataRefs":{},"dataId":"c11we","props":{"type":"WPhotoProperties","displayMode":"fill"},"propsId":"WPht0-1bbo"}]';
                        window.mobileEditorUIDriver.addComponentsToPage(componentsToAddStringified, function () {
                            window.mobileEditorUIDriver.moveResizeComponent("SELECTED_COMPONENT", {x: 200, y: 600, updateLayout: true});


                            window.mobileEditorUIDriver.switchToMobileEditor(function () {
                                var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","SldShwGllry0-hsf","WPht1-e57","WPht2-1dvb","WPht1-13z5","WPht2-o8d","WPht3-8wv","WPht0-mu","WPht0-1bbo"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---SldShwGllry0-hsf,&@slashn---WPht1-e57,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht2-o8d,&@slashn---WPht3-8wv,&@slashn---WPht0-mu,&@slashn---WPht0-1bbo&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:791}&@slashn---SldShwGllry0-hsf:{x:20,y:10,width:280,height:172}&@slashn---WPht1-e57:{x:20,y:192,width:280,height:63}&@slashn---WPht2-1dvb:{x:111,y:345,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:265,width:223,height:137}&@slashn---WPht2-o8d:{x:47,y:435,width:100,height:135}&@slashn---WPht3-8wv:{x:174,y:435,width:100,height:135}&@slashn---WPht0-mu:{x:110,y:580,width:100,height:135}&@slashn---WPht0-1bbo:{x:20,y:725,width:280,height:46}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:908,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:791}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:791}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---SldShwGllry0-hsf:[&@slashn{distance:10,locked:true,originalValue:192,targetComponent:WPht1-e57,topToTop:182,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:265,targetComponent:WPht1-13z5,topToTop:73,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:10,locked:true,originalValue:435,targetComponent:WPht2-o8d,topToTop:90,type:BOTTOM_TOP}&@slashn{distance:10,locked:true,originalValue:435,targetComponent:WPht3-8wv,topToTop:90,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:345,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-o8d:[&@slashn{distance:10,locked:true,originalValue:580,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht3-8wv:[&@slashn{distance:10,locked:true,originalValue:580,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-mu:[&@slashn{distance:10,locked:true,originalValue:725,targetComponent:WPht0-1bbo,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-1bbo:[&@slashn{distance:0,locked:true,originalValue:771,targetComponent:mainPage,topToTop:725,type:BOTTOM_PARENT}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                                window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);

                            });
                        });
                    }); //it

                    //PASS
                    it('+ thin component, width=10px, before two thin components forming a block (should push down both)', function () {
                        var componentsToAddStringified = '[{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht0-1bbo","styleId":"wp1","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":320,"y":30,"width":400,"height":65,"scale":1,"anchors":[{"type":"BOTTOM_TOP","targetComponent":"SldShwGllry0-hsf","locked":true,"distance":50,"topToTop":115,"originalValue":145},{"type":"BOTTOM_TOP","targetComponent":"WPht1-e57","locked":false,"distance":120,"topToTop":185,"originalValue":215}]},"data":{"type":"Image","uri":"da9ed5_c23622c8b2a1eab837f3e10aee99a941.jpg","title":"Wide_wall.jpg","description":"","width":2560,"height":1024,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null,"href":""},"dataRefs":{},"dataId":"c11we","props":{"type":"WPhotoProperties","displayMode":"fill"},"propsId":"WPht0-1bbo"}]';
                        window.mobileEditorUIDriver.addComponentsToPage(componentsToAddStringified, function () {
                            window.mobileEditorUIDriver.sleep(300, function () {

                                window.mobileEditorUIDriver.moveResizeComponent("WPht0-1bbo", {width: 10, x: 430, y: 265, updateLayout: true});

                                window.mobileEditorUIDriver.switchToMobileEditor(function () {
                                    var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","SldShwGllry0-hsf","WPht1-e57","WPht2-1dvb","WPht1-13z5","WPht2-o8d","WPht3-8wv","WPht0-mu","WPht0-1bbo"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---SldShwGllry0-hsf,&@slashn---WPht1-e57,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht2-o8d,&@slashn---WPht3-8wv,&@slashn---WPht0-mu,&@slashn---WPht0-1bbo&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:810}&@slashn---SldShwGllry0-hsf:{x:20,y:10,width:280,height:172}&@slashn---WPht1-e57:{x:20,y:192,width:280,height:63}&@slashn---WPht2-1dvb:{x:111,y:345,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:265,width:223,height:137}&@slashn---WPht2-o8d:{x:47,y:510,width:100,height:135}&@slashn---WPht3-8wv:{x:174,y:510,width:100,height:135}&@slashn---WPht0-mu:{x:110,y:655,width:100,height:135}&@slashn---WPht0-1bbo:{x:155,y:435,width:10,height:65}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:927,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:810}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:810}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---SldShwGllry0-hsf:[&@slashn{distance:10,locked:true,originalValue:192,targetComponent:WPht1-e57,topToTop:182,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:265,targetComponent:WPht1-13z5,topToTop:73,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:85,locked:false,originalValue:510,targetComponent:WPht2-o8d,topToTop:165,type:BOTTOM_TOP}&@slashn{distance:85,locked:false,originalValue:510,targetComponent:WPht3-8wv,topToTop:165,type:BOTTOM_TOP}&@slashn{distance:10,locked:true,originalValue:435,targetComponent:WPht0-1bbo,topToTop:90,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:345,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-o8d:[&@slashn{distance:10,locked:true,originalValue:655,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht3-8wv:[&@slashn{distance:10,locked:true,originalValue:655,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-mu:[&@slashn{distance:0,locked:true,originalValue:790,targetComponent:mainPage,topToTop:655,type:BOTTOM_PARENT}&@slashn]&@slashn---WPht0-1bbo:[&@slashn{distance:155,locked:false,originalValue:655,targetComponent:WPht0-mu,topToTop:220,type:BOTTOM_TOP}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                                    window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);

                                });
                            });
                        });
                    }); //it
                }); //it

                describe("addition of multiple components", function () {

                    //PASS
                    it('+ adding two components, in two separate places (from different blocks)', function () {
                        var componentsToAddStringified = '[{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht0-1bbo","styleId":"wp1","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":320,"y":30,"width":400,"height":65,"scale":1,"anchors":[{"type":"BOTTOM_TOP","targetComponent":"SldShwGllry0-hsf","locked":true,"distance":50,"topToTop":115,"originalValue":145},{"type":"BOTTOM_TOP","targetComponent":"WPht1-e57","locked":false,"distance":120,"topToTop":185,"originalValue":215}]},"data":{"type":"Image","uri":"da9ed5_c23622c8b2a1eab837f3e10aee99a941.jpg","title":"Wide_wall.jpg","description":"","width":2560,"height":1024,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null,"href":""},"dataRefs":{},"dataId":"c11we","props":{"type":"WPhotoProperties","displayMode":"fill"},"propsId":"WPht0-1bbo"}, {"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht0-bvh","styleId":"wp1","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":665,"y":90,"width":200,"height":65,"scale":1,"anchors":[{"type":"BOTTOM_PARENT","targetComponent":"mainPage","locked":false,"distance":420,"topToTop":90,"originalValue":575}]},"data":{"type":"Image","uri":"d075d253771f7e1509844cbd5a12d080.jpg","title":"Butterfly","description":"","width":1024,"height":683,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null,"href":""},"dataRefs":{},"dataId":"c9k0","props":{"type":"WPhotoProperties","displayMode":"fill","metaData":{}},"propsId":"c18vl"}]';

                        window.mobileEditorUIDriver.addComponentsToPage(componentsToAddStringified, function () {
                            window.mobileEditorUIDriver.moveResizeComponent("WPht0-1bbo", {width: 50, x: 430, y: 265, updateLayout: true});
                            window.mobileEditorUIDriver.moveResizeComponent("WPht0-bvh", {width: 200, x: 175, y: 620, updateLayout: true});

                            window.mobileEditorUIDriver.switchToMobileEditor(function () {
                                var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","SldShwGllry0-hsf","WPht1-e57","WPht2-1dvb","WPht1-13z5","WPht2-o8d","WPht3-8wv","WPht0-mu","WPht0-1bbo","WPht0-bvh"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---SldShwGllry0-hsf,&@slashn---WPht1-e57,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht2-o8d,&@slashn---WPht3-8wv,&@slashn---WPht0-mu,&@slashn---WPht0-1bbo,&@slashn---WPht0-bvh&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:911}&@slashn---SldShwGllry0-hsf:{x:20,y:10,width:280,height:172}&@slashn---WPht1-e57:{x:20,y:192,width:280,height:63}&@slashn---WPht2-1dvb:{x:111,y:345,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:265,width:223,height:137}&@slashn---WPht2-o8d:{x:47,y:510,width:100,height:135}&@slashn---WPht3-8wv:{x:174,y:510,width:100,height:135}&@slashn---WPht0-mu:{x:110,y:655,width:100,height:135}&@slashn---WPht0-1bbo:{x:135,y:435,width:50,height:65}&@slashn---WPht0-bvh:{x:20,y:800,width:280,height:91}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:1028,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:911}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:911}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---SldShwGllry0-hsf:[&@slashn{distance:10,locked:true,originalValue:192,targetComponent:WPht1-e57,topToTop:182,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:265,targetComponent:WPht1-13z5,topToTop:73,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:10,locked:true,originalValue:435,targetComponent:WPht0-1bbo,topToTop:90,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:345,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-o8d:[&@slashn{distance:10,locked:true,originalValue:655,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht3-8wv:[&@slashn{distance:10,locked:true,originalValue:655,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-mu:[&@slashn{distance:10,locked:true,originalValue:800,targetComponent:WPht0-bvh,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-1bbo:[&@slashn{distance:10,locked:true,originalValue:510,targetComponent:WPht2-o8d,topToTop:75,type:BOTTOM_TOP}&@slashn{distance:10,locked:true,originalValue:510,targetComponent:WPht3-8wv,topToTop:75,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-bvh:[&@slashn{distance:0,locked:true,originalValue:891,targetComponent:mainPage,topToTop:800,type:BOTTOM_PARENT}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                                window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);

                            });
                        });
                    }); //it

                    //PASS
                    it('+ adding two components, in two separate places (from different blocks), where the upper component z-order is bigger', function () {
                        var componentsToAddStringified = '[{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht0-1bbo","styleId":"wp1","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":320,"y":30,"width":400,"height":65,"scale":1,"anchors":[{"type":"BOTTOM_TOP","targetComponent":"SldShwGllry0-hsf","locked":true,"distance":50,"topToTop":115,"originalValue":145},{"type":"BOTTOM_TOP","targetComponent":"WPht1-e57","locked":false,"distance":120,"topToTop":185,"originalValue":215}]},"data":{"type":"Image","uri":"da9ed5_c23622c8b2a1eab837f3e10aee99a941.jpg","title":"Wide_wall.jpg","description":"","width":2560,"height":1024,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null,"href":""},"dataRefs":{},"dataId":"c11we","props":{"type":"WPhotoProperties","displayMode":"fill"},"propsId":"WPht0-1bbo"}, {"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht0-bvh","styleId":"wp1","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":665,"y":90,"width":200,"height":65,"scale":1,"anchors":[{"type":"BOTTOM_PARENT","targetComponent":"mainPage","locked":false,"distance":420,"topToTop":90,"originalValue":575}]},"data":{"type":"Image","uri":"d075d253771f7e1509844cbd5a12d080.jpg","title":"Butterfly","description":"","width":1024,"height":683,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null,"href":""},"dataRefs":{},"dataId":"c9k0","props":{"type":"WPhotoProperties","displayMode":"fill","metaData":{}},"propsId":"c18vl"}]';

                        window.mobileEditorUIDriver.addComponentsToPage(componentsToAddStringified, function () {
                            window.mobileEditorUIDriver.moveResizeComponent("WPht0-1bbo", {width: 50, x: 430, y: 265, updateLayout: true});
                            window.mobileEditorUIDriver.moveResizeComponent("WPht0-bvh", {width: 200, x: 175, y: 620, updateLayout: true});
                            window.mobileEditorUIDriver.moveComponentToTop("WPht0-1bbo");

                            window.mobileEditorUIDriver.switchToMobileEditor(function () {
                                expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","SldShwGllry0-hsf","WPht1-e57","WPht2-1dvb","WPht1-13z5","WPht2-o8d","WPht3-8wv","WPht0-mu","WPht0-bvh","WPht0-1bbo"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---SldShwGllry0-hsf,&@slashn---WPht1-e57,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht2-o8d,&@slashn---WPht3-8wv,&@slashn---WPht0-mu,&@slashn---WPht0-bvh,&@slashn---WPht0-1bbo&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:911}&@slashn---SldShwGllry0-hsf:{x:20,y:10,width:280,height:172}&@slashn---WPht1-e57:{x:20,y:192,width:280,height:63}&@slashn---WPht2-1dvb:{x:111,y:345,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:265,width:223,height:137}&@slashn---WPht2-o8d:{x:47,y:510,width:100,height:135}&@slashn---WPht3-8wv:{x:174,y:510,width:100,height:135}&@slashn---WPht0-mu:{x:110,y:655,width:100,height:135}&@slashn---WPht0-bvh:{x:20,y:800,width:280,height:91}&@slashn---WPht0-1bbo:{x:135,y:435,width:50,height:65}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:1028,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:911}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:911}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---SldShwGllry0-hsf:[&@slashn{distance:10,locked:true,originalValue:192,targetComponent:WPht1-e57,topToTop:182,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:265,targetComponent:WPht1-13z5,topToTop:73,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:10,locked:true,originalValue:435,targetComponent:WPht0-1bbo,topToTop:90,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:345,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-o8d:[&@slashn{distance:10,locked:true,originalValue:655,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht3-8wv:[&@slashn{distance:10,locked:true,originalValue:655,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-mu:[&@slashn{distance:10,locked:true,originalValue:800,targetComponent:WPht0-bvh,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-bvh:[&@slashn{distance:0,locked:true,originalValue:891,targetComponent:mainPage,topToTop:800,type:BOTTOM_PARENT}&@slashn]&@slashn---WPht0-1bbo:[&@slashn{distance:10,locked:true,originalValue:510,targetComponent:WPht2-o8d,topToTop:75,type:BOTTOM_TOP}&@slashn{distance:10,locked:true,originalValue:510,targetComponent:WPht3-8wv,topToTop:75,type:BOTTOM_TOP}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                                window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);

                            });
                        });
                    }); //it

                    //PASS
                    it('+ adding two components with partial overlap, forming a composition', function () {
                        var componentsToAddStringified = '[{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht0-1bbo","styleId":"wp1","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":320,"y":30,"width":400,"height":65,"scale":1,"anchors":[{"type":"BOTTOM_TOP","targetComponent":"SldShwGllry0-hsf","locked":true,"distance":50,"topToTop":115,"originalValue":145},{"type":"BOTTOM_TOP","targetComponent":"WPht1-e57","locked":false,"distance":120,"topToTop":185,"originalValue":215}]},"data":{"type":"Image","uri":"da9ed5_c23622c8b2a1eab837f3e10aee99a941.jpg","title":"Wide_wall.jpg","description":"","width":2560,"height":1024,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null,"href":""},"dataRefs":{},"dataId":"c11we","props":{"type":"WPhotoProperties","displayMode":"fill"},"propsId":"WPht0-1bbo"}, {"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht0-bvh","styleId":"wp1","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":665,"y":90,"width":200,"height":65,"scale":1,"anchors":[{"type":"BOTTOM_PARENT","targetComponent":"mainPage","locked":false,"distance":420,"topToTop":90,"originalValue":575}]},"data":{"type":"Image","uri":"d075d253771f7e1509844cbd5a12d080.jpg","title":"Butterfly","description":"","width":1024,"height":683,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null,"href":""},"dataRefs":{},"dataId":"c9k0","props":{"type":"WPhotoProperties","displayMode":"fill","metaData":{}},"propsId":"c18vl"}]';

                        window.mobileEditorUIDriver.addComponentsToPage(componentsToAddStringified, function () {
                            window.mobileEditorUIDriver.sleep(500, function () {

                                window.mobileEditorUIDriver.moveResizeComponent("WPht0-1bbo", {width: 170, height: 110, x: 430, y: 265, updateLayout: true});
                                window.mobileEditorUIDriver.moveResizeComponent("WPht0-bvh", {width: 380, height: 115, x: 480, y: 295, updateLayout: true});

                                window.mobileEditorUIDriver.switchToMobileEditor(function () {
                                    expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","SldShwGllry0-hsf","WPht1-e57","WPht2-1dvb","WPht1-13z5","WPht2-o8d","WPht3-8wv","WPht0-mu","WPht0-1bbo","WPht0-bvh"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---SldShwGllry0-hsf,&@slashn---WPht1-e57,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht2-o8d,&@slashn---WPht3-8wv,&@slashn---WPht0-mu,&@slashn---WPht0-1bbo,&@slashn---WPht0-bvh&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:839}&@slashn---SldShwGllry0-hsf:{x:20,y:10,width:280,height:172}&@slashn---WPht1-e57:{x:20,y:192,width:280,height:63}&@slashn---WPht2-1dvb:{x:111,y:345,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:265,width:223,height:137}&@slashn---WPht2-o8d:{x:47,y:539,width:100,height:135}&@slashn---WPht3-8wv:{x:174,y:539,width:100,height:135}&@slashn---WPht0-mu:{x:110,y:684,width:100,height:135}&@slashn---WPht0-1bbo:{x:20,y:435,width:111,height:72}&@slashn---WPht0-bvh:{x:53,y:455,width:247,height:75}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:956,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:839}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:839}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---SldShwGllry0-hsf:[&@slashn{distance:10,locked:true,originalValue:192,targetComponent:WPht1-e57,topToTop:182,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:265,targetComponent:WPht1-13z5,topToTop:73,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:10,locked:true,originalValue:435,targetComponent:WPht0-1bbo,topToTop:90,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:345,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-o8d:[&@slashn{distance:10,locked:true,originalValue:684,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht3-8wv:[&@slashn{distance:10,locked:true,originalValue:684,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-mu:[&@slashn{distance:0,locked:true,originalValue:819,targetComponent:mainPage,topToTop:684,type:BOTTOM_PARENT}&@slashn]&@slashn---WPht0-1bbo:[&@slashn{distance:32,locked:true,originalValue:539,targetComponent:WPht2-o8d,topToTop:104,type:BOTTOM_TOP}&@slashn{distance:20,locked:true,originalValue:455,targetComponent:WPht0-bvh,topToTop:20,type:TOP_TOP}&@slashn]&@slashn---WPht0-bvh:[&@slashn{distance:9,locked:true,originalValue:539,targetComponent:WPht2-o8d,topToTop:84,type:BOTTOM_TOP}&@slashn{distance:9,locked:true,originalValue:539,targetComponent:WPht3-8wv,topToTop:84,type:BOTTOM_TOP}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                                    window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);
                                });
                            });
                        });
                    }); //it

                    //PASS
                    it('+ adding two components with containment overlap, forming a composition', function () {
                        var componentsToAddStringified = '[{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht0-1bbo","styleId":"wp1","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":320,"y":30,"width":400,"height":65,"scale":1,"anchors":[{"type":"BOTTOM_TOP","targetComponent":"SldShwGllry0-hsf","locked":true,"distance":50,"topToTop":115,"originalValue":145},{"type":"BOTTOM_TOP","targetComponent":"WPht1-e57","locked":false,"distance":120,"topToTop":185,"originalValue":215}]},"data":{"type":"Image","uri":"da9ed5_c23622c8b2a1eab837f3e10aee99a941.jpg","title":"Wide_wall.jpg","description":"","width":2560,"height":1024,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null,"href":""},"dataRefs":{},"dataId":"c11we","props":{"type":"WPhotoProperties","displayMode":"fill"},"propsId":"WPht0-1bbo"}, {"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht0-bvh","styleId":"wp1","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":665,"y":90,"width":200,"height":65,"scale":1,"anchors":[{"type":"BOTTOM_PARENT","targetComponent":"mainPage","locked":false,"distance":420,"topToTop":90,"originalValue":575}]},"data":{"type":"Image","uri":"d075d253771f7e1509844cbd5a12d080.jpg","title":"Butterfly","description":"","width":1024,"height":683,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null,"href":""},"dataRefs":{},"dataId":"c9k0","props":{"type":"WPhotoProperties","displayMode":"fill","metaData":{}},"propsId":"c18vl"}]';

                        window.mobileEditorUIDriver.addComponentsToPage(componentsToAddStringified, function () {
                            window.mobileEditorUIDriver.moveResizeComponent("WPht0-1bbo", {width: 480, height: 155, x: 430, y: 265, updateLayout: true});
                            window.mobileEditorUIDriver.moveResizeComponent("WPht0-bvh", {width: 380, height: 115, x: 480, y: 295, updateLayout: true});

                            window.mobileEditorUIDriver.switchToMobileEditor(function () {
                                expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","SldShwGllry0-hsf","WPht1-e57","WPht2-1dvb","WPht1-13z5","WPht2-o8d","WPht3-8wv","WPht0-mu","WPht0-1bbo","WPht0-bvh"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---SldShwGllry0-hsf,&@slashn---WPht1-e57,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht2-o8d,&@slashn---WPht3-8wv,&@slashn---WPht0-mu,&@slashn---WPht0-1bbo,&@slashn---WPht0-bvh&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:835}&@slashn---SldShwGllry0-hsf:{x:20,y:10,width:280,height:172}&@slashn---WPht1-e57:{x:20,y:192,width:280,height:63}&@slashn---WPht2-1dvb:{x:111,y:345,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:265,width:223,height:137}&@slashn---WPht2-o8d:{x:47,y:535,width:100,height:135}&@slashn---WPht3-8wv:{x:174,y:535,width:100,height:135}&@slashn---WPht0-mu:{x:110,y:680,width:100,height:135}&@slashn---WPht0-1bbo:{x:20,y:435,width:280,height:90}&@slashn---WPht0-bvh:{x:49,y:453,width:222,height:67}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:952,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:835}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:835}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---SldShwGllry0-hsf:[&@slashn{distance:10,locked:true,originalValue:192,targetComponent:WPht1-e57,topToTop:182,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:265,targetComponent:WPht1-13z5,topToTop:73,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:10,locked:true,originalValue:435,targetComponent:WPht0-1bbo,topToTop:90,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:345,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-o8d:[&@slashn{distance:10,locked:true,originalValue:680,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht3-8wv:[&@slashn{distance:10,locked:true,originalValue:680,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-mu:[&@slashn{distance:0,locked:true,originalValue:815,targetComponent:mainPage,topToTop:680,type:BOTTOM_PARENT}&@slashn]&@slashn---WPht0-1bbo:[&@slashn{distance:10,locked:true,originalValue:535,targetComponent:WPht2-o8d,topToTop:100,type:BOTTOM_TOP}&@slashn{distance:10,locked:true,originalValue:535,targetComponent:WPht3-8wv,topToTop:100,type:BOTTOM_TOP}&@slashn{distance:18,locked:true,originalValue:453,targetComponent:WPht0-bvh,topToTop:18,type:TOP_TOP}&@slashn]&@slashn---WPht0-bvh:[&@slashn{distance:5,locked:true,originalValue:90,targetComponent:WPht0-1bbo,topToTop:18,type:BOTTOM_BOTTOM}&@slashn{distance:15,locked:true,originalValue:535,targetComponent:WPht2-o8d,topToTop:82,type:BOTTOM_TOP}&@slashn{distance:15,locked:true,originalValue:535,targetComponent:WPht3-8wv,topToTop:82,type:BOTTOM_TOP}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                                window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);
                            });
                        });
                    }); //it

                    //PASS
                    it('+ adding two small components next to each other, that should be placed next to each other', function () {
                        var componentsToAddStringified = '[{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht0-1bbo","styleId":"wp1","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":320,"y":30,"width":400,"height":65,"scale":1,"anchors":[{"type":"BOTTOM_TOP","targetComponent":"SldShwGllry0-hsf","locked":true,"distance":50,"topToTop":115,"originalValue":145},{"type":"BOTTOM_TOP","targetComponent":"WPht1-e57","locked":false,"distance":120,"topToTop":185,"originalValue":215}]},"data":{"type":"Image","uri":"da9ed5_c23622c8b2a1eab837f3e10aee99a941.jpg","title":"Wide_wall.jpg","description":"","width":2560,"height":1024,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null,"href":""},"dataRefs":{},"dataId":"c11we","props":{"type":"WPhotoProperties","displayMode":"fill"},"propsId":"WPht0-1bbo"}, {"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht0-bvh","styleId":"wp1","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":665,"y":90,"width":200,"height":65,"scale":1,"anchors":[{"type":"BOTTOM_PARENT","targetComponent":"mainPage","locked":false,"distance":420,"topToTop":90,"originalValue":575}]},"data":{"type":"Image","uri":"d075d253771f7e1509844cbd5a12d080.jpg","title":"Butterfly","description":"","width":1024,"height":683,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null,"href":""},"dataRefs":{},"dataId":"c9k0","props":{"type":"WPhotoProperties","displayMode":"fill","metaData":{}},"propsId":"c18vl"}]';

                        window.mobileEditorUIDriver.addComponentsToPage(componentsToAddStringified, function () {
                            window.mobileEditorUIDriver.moveResizeComponent("WPht0-1bbo", {width: 35, height: 85, x: 430, y: 265, updateLayout: true});
                            window.mobileEditorUIDriver.moveResizeComponent("WPht0-bvh", {width: 50, height: 115, x: 480, y: 295, updateLayout: true});

                            window.mobileEditorUIDriver.switchToMobileEditor(function () {
                                expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","SldShwGllry0-hsf","WPht1-e57","WPht2-1dvb","WPht1-13z5","WPht2-o8d","WPht3-8wv","WPht0-mu","WPht0-1bbo","WPht0-bvh"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---SldShwGllry0-hsf,&@slashn---WPht1-e57,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht2-o8d,&@slashn---WPht3-8wv,&@slashn---WPht0-mu,&@slashn---WPht0-1bbo,&@slashn---WPht0-bvh&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:860}&@slashn---SldShwGllry0-hsf:{x:20,y:10,width:280,height:172}&@slashn---WPht1-e57:{x:20,y:192,width:280,height:63}&@slashn---WPht2-1dvb:{x:111,y:345,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:265,width:223,height:137}&@slashn---WPht2-o8d:{x:47,y:560,width:100,height:135}&@slashn---WPht3-8wv:{x:174,y:560,width:100,height:135}&@slashn---WPht0-mu:{x:110,y:705,width:100,height:135}&@slashn---WPht0-1bbo:{x:85,y:435,width:35,height:85}&@slashn---WPht0-bvh:{x:185,y:435,width:50,height:115}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:977,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:860}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:860}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---SldShwGllry0-hsf:[&@slashn{distance:10,locked:true,originalValue:192,targetComponent:WPht1-e57,topToTop:182,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:265,targetComponent:WPht1-13z5,topToTop:73,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:10,locked:true,originalValue:435,targetComponent:WPht0-1bbo,topToTop:90,type:BOTTOM_TOP}&@slashn{distance:10,locked:true,originalValue:435,targetComponent:WPht0-bvh,topToTop:90,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:345,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-o8d:[&@slashn{distance:10,locked:true,originalValue:705,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht3-8wv:[&@slashn{distance:10,locked:true,originalValue:705,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-mu:[&@slashn{distance:0,locked:true,originalValue:840,targetComponent:mainPage,topToTop:705,type:BOTTOM_PARENT}&@slashn]&@slashn---WPht0-1bbo:[&@slashn{distance:40,locked:true,originalValue:560,targetComponent:WPht2-o8d,topToTop:125,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-bvh:[&@slashn{distance:10,locked:true,originalValue:560,targetComponent:WPht3-8wv,topToTop:125,type:BOTTOM_TOP}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                                window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);
                            });
                        });
                    }); //it

                    //PASS
                    it("+ adding two image components, where one of them has a text description, should be added where the text should be in the middle, due to 'text and it correlating visual' heuristic", function () {
                        var componentsToAddStringified = '[{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht0-bvh","styleId":"wp1","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":675,"y":265,"width":280,"height":65,"scale":1,"rotationInDegrees":0,"anchors":[{"type":"BOTTOM_PARENT","targetComponent":"mainPage","locked":false,"distance":245,"topToTop":265,"originalValue":575}]},"data":{"type":"Image","uri":"d075d253771f7e1509844cbd5a12d080.jpg","title":"Butterfly","description":"","width":1024,"height":683,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null,"href":""},"dataRefs":{},"dataId":"c9k0","props":{"type":"WPhotoProperties","displayMode":"fill","metaData":{}},"propsId":"c18vl"},{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht0-1bbo","styleId":"wp1","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":370,"y":265,"width":255,"height":65,"scale":1,"rotationInDegrees":0,"anchors":[{"type":"BOTTOM_TOP","targetComponent":"WRchTxt0-17a7","locked":true,"distance":10,"topToTop":75,"originalValue":340},{"type":"BOTTOM_TOP","targetComponent":"WPht3-8wv","locked":false,"distance":105,"topToTop":170,"originalValue":435}]},"data":{"type":"Image","uri":"da9ed5_c23622c8b2a1eab837f3e10aee99a941.jpg","title":"Wide_wall.jpg","description":"","width":2560,"height":1024,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null,"href":""},"dataRefs":{},"dataId":"c11we","props":{"type":"WPhotoProperties","displayMode":"fill","metaData":{}},"propsId":"WPht0-1bbo"},{"componentType":"wysiwyg.viewer.components.WRichText","type":"Component","id":"WRchTxt0-17a7","styleId":"txtNew","skin":"wysiwyg.viewer.skins.WRichTextNewSkin","layout":{"x":490,"y":340,"width":75,"height":50,"scale":1,"rotationInDegrees":0,"anchors":[{"type":"BOTTOM_TOP","targetComponent":"WPht0-mu","locked":true,"distance":50,"topToTop":100,"originalValue":440}]},"data":{"type":"StyledText","text":"<h2 class=&@slash"font_2&@slash">Title.&nbsp;</h2>&@slashn","stylesMapId":"CK_EDITOR_PARAGRAPH_STYLES","metaData":{"isPreset":false}},"dataRefs":{},"dataId":"cuaw"}]';

                        window.mobileEditorUIDriver.addComponentsToPage(componentsToAddStringified, function () {
                            window.mobileEditorUIDriver.moveResizeComponent("WPht0-1bbo", {width: 190, height: 80, x: 425, y: 250, updateLayout: true});
                            window.mobileEditorUIDriver.moveResizeComponent("WPht0-bvh", {width: 265, height: 80, x: 675, y: 255, updateLayout: true});

                            window.mobileEditorUIDriver.switchToMobileEditor(function () {
                                var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","SldShwGllry0-hsf","WPht1-e57","WPht2-1dvb","WPht1-13z5","WPht2-o8d","WPht3-8wv","WPht0-mu","WPht0-1bbo","WRchTxt0-17a7","WPht0-bvh"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---SldShwGllry0-hsf,&@slashn---WPht1-e57,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht2-o8d,&@slashn---WPht3-8wv,&@slashn---WPht0-mu,&@slashn---WPht0-1bbo,&@slashn---WRchTxt0-17a7,&@slashn---WPht0-bvh&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:1000}&@slashn---SldShwGllry0-hsf:{x:20,y:10,width:280,height:172}&@slashn---WPht1-e57:{x:20,y:192,width:280,height:63}&@slashn---WPht2-1dvb:{x:111,y:345,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:265,width:223,height:137}&@slashn---WPht2-o8d:{x:47,y:700,width:100,height:135}&@slashn---WPht3-8wv:{x:174,y:700,width:100,height:135}&@slashn---WPht0-mu:{x:110,y:845,width:100,height:135}&@slashn---WPht0-1bbo:{x:20,y:435,width:280,height:118}&@slashn---WRchTxt0-17a7:{x:127,y:563,width:65,height:32}&@slashn---WPht0-bvh:{x:20,y:605,width:280,height:85}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:1117,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:1000}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:1000}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---SldShwGllry0-hsf:[&@slashn{distance:10,locked:true,originalValue:192,targetComponent:WPht1-e57,topToTop:182,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:265,targetComponent:WPht1-13z5,topToTop:73,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:10,locked:true,originalValue:435,targetComponent:WPht0-1bbo,topToTop:90,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:345,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-o8d:[&@slashn{distance:10,locked:true,originalValue:845,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht3-8wv:[&@slashn{distance:10,locked:true,originalValue:845,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-mu:[&@slashn{distance:0,locked:true,originalValue:980,targetComponent:mainPage,topToTop:845,type:BOTTOM_PARENT}&@slashn]&@slashn---WPht0-1bbo:[&@slashn{distance:10,locked:true,originalValue:563,targetComponent:WRchTxt0-17a7,topToTop:128,type:BOTTOM_TOP}&@slashn]&@slashn---WRchTxt0-17a7:[&@slashn{distance:10,locked:true,originalValue:605,targetComponent:WPht0-bvh,topToTop:42,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-bvh:[&@slashn{distance:10,locked:true,originalValue:700,targetComponent:WPht2-o8d,topToTop:95,type:BOTTOM_TOP}&@slashn{distance:10,locked:true,originalValue:700,targetComponent:WPht3-8wv,topToTop:95,type:BOTTOM_TOP}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                                window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);
                            });
                        });
                    }); //it

                    //PASS
                    it("+ adding three image components, where two of them are really close vertically, should be added where the two close components are next to each other, due to 'clustering' heuristic", function () {
                        var componentsToAddStringified = '[{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht0-bvh","styleId":"wp1","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":900,"y":255,"width":195,"height":80,"scale":1,"rotationInDegrees":0,"anchors":[{"type":"BOTTOM_PARENT","targetComponent":"mainPage","locked":false,"distance":240,"topToTop":255,"originalValue":575}]},"data":{"type":"Image","uri":"d075d253771f7e1509844cbd5a12d080.jpg","title":"Butterfly","description":"","width":1024,"height":683,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null,"href":""},"dataRefs":{},"dataId":"c9k0","props":{"type":"WPhotoProperties","displayMode":"fill","metaData":{}},"propsId":"c18vl"},{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht0-1bbo","styleId":"wp1","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":345,"y":245,"width":190,"height":80,"scale":1,"rotationInDegrees":0,"anchors":[{"type":"BOTTOM_TOP","targetComponent":"WPht0-fd4","locked":true,"distance":5,"topToTop":85,"originalValue":330}]},"data":{"type":"Image","uri":"da9ed5_c23622c8b2a1eab837f3e10aee99a941.jpg","title":"Wide_wall.jpg","description":"","width":2560,"height":1024,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null,"href":""},"dataRefs":{},"dataId":"c11we","props":{"type":"WPhotoProperties","displayMode":"fill","metaData":{}},"propsId":"WPht0-1bbo"},{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht0-fd4","styleId":"wp1","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":345,"y":330,"width":141,"height":52,"scale":1,"rotationInDegrees":0,"anchors":[{"type":"BOTTOM_TOP","targetComponent":"WPht3-8wv","locked":true,"distance":53,"topToTop":105,"originalValue":435}]},"data":{"type":"Image","uri":"78d8d02385fedc4d1aabf31e0ac1b256.jpg","title":"Tube of Blue Paint ","description":"","width":1024,"height":683,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null,"href":""},"dataRefs":{},"dataId":"c1zgn","props":{"type":"WPhotoProperties","displayMode":"fill","metaData":{}},"propsId":"WPht0-fd4"}]';

                        window.mobileEditorUIDriver.addComponentsToPage(componentsToAddStringified, function () {
                            window.mobileEditorUIDriver.switchToMobileEditor(function () {
                                expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","SldShwGllry0-hsf","WPht1-e57","WPht2-1dvb","WPht1-13z5","WPht2-o8d","WPht3-8wv","WPht0-mu","WPht0-1bbo","WPht0-fd4","WPht0-bvh"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---SldShwGllry0-hsf,&@slashn---WPht1-e57,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht2-o8d,&@slashn---WPht3-8wv,&@slashn---WPht0-mu,&@slashn---WPht0-1bbo,&@slashn---WPht0-fd4,&@slashn---WPht0-bvh&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:1101}&@slashn---SldShwGllry0-hsf:{x:20,y:10,width:280,height:172}&@slashn---WPht1-e57:{x:20,y:192,width:280,height:63}&@slashn---WPht2-1dvb:{x:111,y:345,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:265,width:223,height:137}&@slashn---WPht2-o8d:{x:47,y:801,width:100,height:135}&@slashn---WPht3-8wv:{x:174,y:801,width:100,height:135}&@slashn---WPht0-mu:{x:110,y:946,width:100,height:135}&@slashn---WPht0-1bbo:{x:20,y:435,width:280,height:118}&@slashn---WPht0-fd4:{x:20,y:563,width:280,height:103}&@slashn---WPht0-bvh:{x:20,y:676,width:280,height:115}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:1218,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:1101}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:1101}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---SldShwGllry0-hsf:[&@slashn{distance:10,locked:true,originalValue:192,targetComponent:WPht1-e57,topToTop:182,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:265,targetComponent:WPht1-13z5,topToTop:73,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:10,locked:true,originalValue:435,targetComponent:WPht0-1bbo,topToTop:90,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:345,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-o8d:[&@slashn{distance:10,locked:true,originalValue:946,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht3-8wv:[&@slashn{distance:10,locked:true,originalValue:946,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-mu:[&@slashn{distance:0,locked:true,originalValue:1081,targetComponent:mainPage,topToTop:946,type:BOTTOM_PARENT}&@slashn]&@slashn---WPht0-1bbo:[&@slashn{distance:10,locked:true,originalValue:563,targetComponent:WPht0-fd4,topToTop:128,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-fd4:[&@slashn{distance:10,locked:true,originalValue:676,targetComponent:WPht0-bvh,topToTop:113,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-bvh:[&@slashn{distance:10,locked:true,originalValue:801,targetComponent:WPht2-o8d,topToTop:125,type:BOTTOM_TOP}&@slashn{distance:10,locked:true,originalValue:801,targetComponent:WPht3-8wv,topToTop:125,type:BOTTOM_TOP}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                                window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);
                            });
                        });
                    }); //it

                    // PASS
                    it("+ adding four components which form two patterns, should be ordered differently than the natual order, due to 'patterns' heuristic", function () {
                        var componentsToAddStringified = '[{"componentType":"wysiwyg.viewer.components.SiteButton","type":"Component","id":"StBttn1-1te","styleId":"b1","skin":"wysiwyg.viewer.skins.button.BasicButton","layout":{"x":700,"y":320,"width":130,"height":28,"scale":1,"rotationInDegrees":0,"anchors":[{"type":"BOTTOM_PARENT","targetComponent":"mainPage","locked":false,"distance":227,"topToTop":320,"originalValue":575}]},"data":{"type":"LinkableButton","metaData":{"isPreset":false},"label":"BUTTON B"},"dataRefs":{},"dataId":"c13vf","props":{"type":"ButtonProperties","align":"center","metaData":{"isPersistent":true},"margin":0},"propsId":"c83v"},{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht1-7pg","styleId":"wp3","skin":"wysiwyg.viewer.skins.photo.LiftedShadowPhoto","layout":{"x":674,"y":231,"width":195,"height":72,"scale":1,"rotationInDegrees":0,"anchors":[{"type":"BOTTOM_TOP","targetComponent":"StBttn1-1te","locked":true,"distance":17,"topToTop":89,"originalValue":320}]},"data":{"type":"Image","metaData":{"isPreset":false,"schemaVersion":"2.0","isHidden":false},"title":"B.jpg","uri":"da9ed5_8e2be720c5a7420ca961cd2a4bd2f755.jpg","description":"","width":234,"height":215,"alt":"","originalImageDataRef":null},"dataRefs":{},"dataId":"c1xf9","props":{"type":"WPhotoProperties","metaData":{"schemaVersion":"1.0"},"displayMode":"fill","onClickBehavior":"goToLink"},"propsId":"c24qj"},{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht0-vlv","styleId":"wp3","skin":"wysiwyg.viewer.skins.photo.LiftedShadowPhoto","layout":{"x":417,"y":231,"width":195,"height":72,"scale":1,"rotationInDegrees":0,"anchors":[{"type":"BOTTOM_TOP","targetComponent":"StBttn0-wdi","locked":true,"distance":17,"topToTop":89,"originalValue":320}]},"data":{"type":"Image","metaData":{"isPreset":false,"schemaVersion":"2.0","isHidden":false},"title":"A.jpg","uri":"da9ed5_5bf0f6d28cfd480cba74400108d7f697.jpg","description":"","width":225,"height":225,"alt":"","originalImageDataRef":null},"dataRefs":{},"dataId":"c22w8","props":{"type":"WPhotoProperties","metaData":{"schemaVersion":"1.0"},"displayMode":"fill","onClickBehavior":"goToLink"},"propsId":"cojc"},{"componentType":"wysiwyg.viewer.components.SiteButton","type":"Component","id":"StBttn0-wdi","styleId":"b1","skin":"wysiwyg.viewer.skins.button.BasicButton","layout":{"x":449,"y":320,"width":130,"height":28,"scale":1,"rotationInDegrees":0,"anchors":[{"type":"BOTTOM_TOP","targetComponent":"WPht3-8wv","locked":false,"distance":87,"topToTop":115,"originalValue":435},{"type":"BOTTOM_TOP","targetComponent":"WPht0-mu","locked":false,"distance":92,"topToTop":120,"originalValue":440}]},"data":{"type":"LinkableButton","metaData":{"isPreset":false},"label":"BUTTON A"},"dataRefs":{},"dataId":"cwzt","props":{"type":"ButtonProperties","align":"center","metaData":{"isPersistent":true},"margin":0},"propsId":"StBttn0-wdi"}]';
                        window.mobileEditorUIDriver.addComponentsToPage(componentsToAddStringified, function () {
                            window.mobileEditorUIDriver.switchToMobileEditor(function () {
                                var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","SldShwGllry0-hsf","WPht1-e57","WPht2-1dvb","WPht1-13z5","WPht2-o8d","WPht3-8wv","WPht0-mu","WPht0-vlv","StBttn0-wdi","WPht1-7pg","StBttn1-1te"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---SldShwGllry0-hsf,&@slashn---WPht1-e57,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht2-o8d,&@slashn---WPht3-8wv,&@slashn---WPht0-mu,&@slashn---WPht0-vlv,&@slashn---StBttn0-wdi,&@slashn---WPht1-7pg,&@slashn---StBttn1-1te&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:1037}&@slashn---SldShwGllry0-hsf:{x:20,y:10,width:280,height:172}&@slashn---WPht1-e57:{x:20,y:192,width:280,height:63}&@slashn---WPht2-1dvb:{x:111,y:345,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:265,width:223,height:137}&@slashn---WPht2-o8d:{x:47,y:737,width:100,height:135}&@slashn---WPht3-8wv:{x:174,y:737,width:100,height:135}&@slashn---WPht0-mu:{x:110,y:882,width:100,height:135}&@slashn---WPht0-vlv:{x:20,y:435,width:280,height:103}&@slashn---StBttn0-wdi:{x:95,y:548,width:130,height:28}&@slashn---WPht1-7pg:{x:20,y:586,width:280,height:103}&@slashn---StBttn1-1te:{x:95,y:699,width:130,height:28}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:1154,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:1037}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:1037}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---SldShwGllry0-hsf:[&@slashn{distance:10,locked:true,originalValue:192,targetComponent:WPht1-e57,topToTop:182,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:265,targetComponent:WPht1-13z5,topToTop:73,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:10,locked:true,originalValue:435,targetComponent:WPht0-vlv,topToTop:90,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:345,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-o8d:[&@slashn{distance:10,locked:true,originalValue:882,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht3-8wv:[&@slashn{distance:10,locked:true,originalValue:882,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-mu:[&@slashn{distance:0,locked:true,originalValue:1017,targetComponent:mainPage,topToTop:882,type:BOTTOM_PARENT}&@slashn]&@slashn---WPht0-vlv:[&@slashn{distance:10,locked:true,originalValue:548,targetComponent:StBttn0-wdi,topToTop:113,type:BOTTOM_TOP}&@slashn]&@slashn---StBttn0-wdi:[&@slashn{distance:10,locked:true,originalValue:586,targetComponent:WPht1-7pg,topToTop:38,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-7pg:[&@slashn{distance:10,locked:true,originalValue:699,targetComponent:StBttn1-1te,topToTop:113,type:BOTTOM_TOP}&@slashn]&@slashn---StBttn1-1te:[&@slashn{distance:10,locked:true,originalValue:737,targetComponent:WPht2-o8d,topToTop:38,type:BOTTOM_TOP}&@slashn{distance:10,locked:true,originalValue:737,targetComponent:WPht3-8wv,topToTop:38,type:BOTTOM_TOP}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                                window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);
                            });
                        });
                    }); //it

                    //PASS
                    it("+ adding two compositions of two components each", function () {
                        var componentsToAddStringified = '[{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht1-1o3","styleId":"wp1","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":750,"y":285,"width":180,"height":100,"scale":1,"rotationInDegrees":0,"anchors":[{"type":"BOTTOM_PARENT","targetComponent":"mainPage","locked":false,"distance":190,"topToTop":285,"originalValue":575}]},"data":{"type":"Image","uri":"d075d253771f7e1509844cbd5a12d080.jpg","title":"Butterfly","description":"","width":1024,"height":683,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null,"href":""},"dataRefs":{},"dataId":"cuu","props":{"type":"WPhotoProperties","displayMode":"fill","metaData":{}},"propsId":"cmty"},{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht0-bvh","styleId":"wp1","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":715,"y":225,"width":180,"height":100,"scale":1,"rotationInDegrees":0,"anchors":[{"type":"BOTTOM_TOP","targetComponent":"WPht1-1o3","locked":true,"distance":-40,"topToTop":60,"originalValue":285}]},"data":{"type":"Image","uri":"d075d253771f7e1509844cbd5a12d080.jpg","title":"Butterfly","description":"","width":1024,"height":683,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null,"href":""},"dataRefs":{},"dataId":"c9k0","props":{"type":"WPhotoProperties","displayMode":"fill","metaData":{}},"propsId":"c18vl"},{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht0-17d","styleId":"wp1","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":480,"y":280,"width":180,"height":100,"scale":1,"rotationInDegrees":0,"anchors":[{"type":"BOTTOM_TOP","targetComponent":"WPht0-mu","locked":true,"distance":60,"topToTop":160,"originalValue":440}]},"data":{"type":"Image","uri":"b879c84536397d352d8ce2a7a14a0374.jpg","title":"Bridal Bouquet","description":"","width":996,"height":1500,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null,"href":""},"dataRefs":{},"dataId":"czxp","props":{"type":"WPhotoProperties","displayMode":"fill","metaData":{}},"propsId":"c1l23"},{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht1-15wl","styleId":"wp1","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":435,"y":230,"width":180,"height":100,"scale":1,"rotationInDegrees":0,"anchors":[{"type":"TOP_TOP","targetComponent":"WPht0-17d","locked":true,"distance":50,"topToTop":50,"originalValue":280},{"type":"BOTTOM_TOP","targetComponent":"WPht3-8wv","locked":false,"distance":105,"topToTop":205,"originalValue":435},{"type":"BOTTOM_TOP","targetComponent":"WPht0-mu","locked":false,"distance":110,"topToTop":210,"originalValue":440}]},"data":{"type":"Image","uri":"b879c84536397d352d8ce2a7a14a0374.jpg","title":"Bridal Bouquet","description":"","width":996,"height":1500,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null,"href":""},"dataRefs":{},"dataId":"c1sx9","props":{"type":"WPhotoProperties","displayMode":"fill","metaData":{}},"propsId":"c1mja"}]';
                        window.mobileEditorUIDriver.addComponentsToPage(componentsToAddStringified, function () {
                            window.mobileEditorUIDriver.switchToMobileEditor(function () {
                                var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","SldShwGllry0-hsf","WPht1-e57","WPht2-1dvb","WPht1-13z5","WPht2-o8d","WPht3-8wv","WPht0-mu","WPht0-17d","WPht1-15wl","WPht1-1o3","WPht0-bvh"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---SldShwGllry0-hsf,&@slashn---WPht1-e57,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht2-o8d,&@slashn---WPht3-8wv,&@slashn---WPht0-mu,&@slashn---WPht0-17d,&@slashn---WPht1-15wl,&@slashn---WPht1-1o3,&@slashn---WPht0-bvh&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:1150}&@slashn---SldShwGllry0-hsf:{x:20,y:10,width:280,height:172}&@slashn---WPht1-e57:{x:20,y:192,width:280,height:63}&@slashn---WPht2-1dvb:{x:111,y:345,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:265,width:223,height:137}&@slashn---WPht2-o8d:{x:47,y:850,width:100,height:135}&@slashn---WPht3-8wv:{x:174,y:850,width:100,height:135}&@slashn---WPht0-mu:{x:110,y:995,width:100,height:135}&@slashn---WPht0-17d:{x:76,y:497,width:224,height:124}&@slashn---WPht1-15wl:{x:20,y:435,width:224,height:124}&@slashn---WPht1-1o3:{x:66,y:710,width:234,height:130}&@slashn---WPht0-bvh:{x:20,y:632,width:234,height:130}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:1267,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:1150}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:1150}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---SldShwGllry0-hsf:[&@slashn{distance:10,locked:true,originalValue:192,targetComponent:WPht1-e57,topToTop:182,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:265,targetComponent:WPht1-13z5,topToTop:73,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:10,locked:true,originalValue:435,targetComponent:WPht1-15wl,topToTop:90,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:345,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-o8d:[&@slashn{distance:10,locked:true,originalValue:995,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht3-8wv:[&@slashn{distance:10,locked:true,originalValue:995,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-mu:[&@slashn{distance:0,locked:true,originalValue:1130,targetComponent:mainPage,topToTop:995,type:BOTTOM_PARENT}&@slashn]&@slashn---WPht0-17d:[&@slashn{distance:11,locked:true,originalValue:632,targetComponent:WPht0-bvh,topToTop:135,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-15wl:[&@slashn{distance:62,locked:true,originalValue:497,targetComponent:WPht0-17d,topToTop:62,type:TOP_TOP}&@slashn{distance:73,locked:false,originalValue:632,targetComponent:WPht0-bvh,topToTop:197,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-1o3:[&@slashn{distance:10,locked:true,originalValue:850,targetComponent:WPht2-o8d,topToTop:140,type:BOTTOM_TOP}&@slashn{distance:10,locked:true,originalValue:850,targetComponent:WPht3-8wv,topToTop:140,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-bvh:[&@slashn{distance:-52,locked:true,originalValue:710,targetComponent:WPht1-1o3,topToTop:78,type:BOTTOM_TOP}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                                window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);
                            });
                        });
                    }); //it

                    //PASS
                    it("+ adding four components which create two background text-image virtual groups", function () {
                        var componentsToAddStringified = '[{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht1-1o3","styleId":"wp1","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":690,"y":230,"width":265,"height":190,"scale":1,"rotationInDegrees":0,"anchors":[{"type":"TOP_TOP","targetComponent":"WRchTxt1-lg5","locked":true,"distance":25,"topToTop":25,"originalValue":255},{"type":"BOTTOM_PARENT","targetComponent":"mainPage","locked":false,"distance":155,"topToTop":230,"originalValue":575}]},"data":{"type":"Image","uri":"d075d253771f7e1509844cbd5a12d080.jpg","title":"Butterfly","description":"","width":1024,"height":683,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null,"href":""},"dataRefs":{},"dataId":"cuu","props":{"type":"WPhotoProperties","displayMode":"fill","metaData":{}},"propsId":"cmty"},{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht0-17d","styleId":"wp1","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":365,"y":235,"width":310,"height":160,"scale":1,"rotationInDegrees":0,"anchors":[{"type":"TOP_TOP","targetComponent":"WRchTxt0-155m","locked":true,"distance":20,"topToTop":20,"originalValue":255},{"type":"BOTTOM_TOP","targetComponent":"WPht3-8wv","locked":true,"distance":40,"topToTop":200,"originalValue":435},{"type":"BOTTOM_TOP","targetComponent":"WPht0-mu","locked":true,"distance":45,"topToTop":205,"originalValue":440}]},"data":{"type":"Image","uri":"b879c84536397d352d8ce2a7a14a0374.jpg","title":"Bridal Bouquet","description":"","width":996,"height":1500,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null,"href":""},"dataRefs":{},"dataId":"czxp","props":{"type":"WPhotoProperties","displayMode":"fill","metaData":{}},"propsId":"c1l23"},{"componentType":"wysiwyg.viewer.components.WRichText","type":"Component","id":"WRchTxt1-lg5","styleId":"txtNew","skin":"wysiwyg.viewer.skins.WRichTextNewSkin","layout":{"x":715,"y":255,"width":210,"height":133,"scale":1,"rotationInDegrees":0,"anchors":[{"type":"BOTTOM_PARENT","targetComponent":"mainPage","locked":false,"distance":263,"topToTop":255,"originalValue":651},{"type":"BOTTOM_BOTTOM","targetComponent":"WPht1-1o3","locked":true,"distance":32,"topToTop":25,"originalValue":190}]},"data":{"type":"StyledText","text":"<p class=&@slash"font_8&@slash"><span style=&@slash"font-size:24px;&@slash">aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa</span></p>&@slashn","stylesMapId":"CK_EDITOR_PARAGRAPH_STYLES","metaData":{"isPreset":false}},"dataRefs":{},"dataId":"c19ly"},{"componentType":"wysiwyg.viewer.components.WRichText","type":"Component","id":"WRchTxt0-155m","styleId":"txtNew","skin":"wysiwyg.viewer.skins.WRichTextNewSkin","layout":{"x":395,"y":255,"width":220,"height":77,"scale":1,"rotationInDegrees":0,"anchors":[{"type":"BOTTOM_TOP","targetComponent":"WPht3-8wv","locked":true,"distance":47,"topToTop":180,"originalValue":435},{"type":"BOTTOM_TOP","targetComponent":"WPht0-mu","locked":true,"distance":52,"topToTop":185,"originalValue":440},{"type":"BOTTOM_BOTTOM","targetComponent":"WPht0-17d","locked":true,"distance":7,"topToTop":20,"originalValue":160}]},"data":{"type":"StyledText","text":"<p class=&@slash"font_8&@slash">aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa</p>&@slashn","stylesMapId":"CK_EDITOR_PARAGRAPH_STYLES","metaData":{"isPreset":false}},"dataRefs":{},"dataId":"c1337"}]';
                        window.mobileEditorUIDriver.addComponentsToPage(componentsToAddStringified, function () {
                            window.mobileEditorUIDriver.sleep(300, function () {
                                window.mobileEditorUIDriver.moveComponentToTop("WRchTxt1-lg5");
                                window.mobileEditorUIDriver.moveComponentToTop("WRchTxt0-155m");
                                window.mobileEditorUIDriver.sleep(300, function () {
                                    window.mobileEditorUIDriver.switchToMobileEditor(function () {
                                        window.mobileEditorUIDriver.sleep(200, function () {
                                            var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","SldShwGllry0-hsf","WPht1-e57","WPht2-1dvb","WPht1-13z5","WPht2-o8d","WPht3-8wv","WPht0-mu","WPht0-17d","WRchTxt0-155m","WPht1-1o3","WRchTxt1-lg5"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---SldShwGllry0-hsf,&@slashn---WPht1-e57,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht2-o8d,&@slashn---WPht3-8wv,&@slashn---WPht0-mu,&@slashn---WPht0-17d,&@slashn---WRchTxt0-155m,&@slashn---WPht1-1o3,&@slashn---WRchTxt1-lg5&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:1121}&@slashn---SldShwGllry0-hsf:{x:20,y:10,width:280,height:172}&@slashn---WPht1-e57:{x:20,y:192,width:280,height:63}&@slashn---WPht2-1dvb:{x:111,y:345,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:265,width:223,height:137}&@slashn---WPht2-o8d:{x:47,y:821,width:100,height:135}&@slashn---WPht3-8wv:{x:174,y:821,width:100,height:135}&@slashn---WPht0-mu:{x:110,y:966,width:100,height:135}&@slashn---WPht0-17d:{x:20,y:435,width:280,height:165}&@slashn---WRchTxt0-155m:{x:47,y:453,width:216,height:140}&@slashn---WPht1-1o3:{x:20,y:610,width:280,height:201}&@slashn---WRchTxt1-lg5:{x:46,y:636,width:243,height:135}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:1238,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:1121}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:1121}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---SldShwGllry0-hsf:[&@slashn{distance:10,locked:true,originalValue:192,targetComponent:WPht1-e57,topToTop:182,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:265,targetComponent:WPht1-13z5,topToTop:73,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:10,locked:true,originalValue:435,targetComponent:WPht0-17d,topToTop:90,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:345,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-o8d:[&@slashn{distance:10,locked:true,originalValue:946,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht3-8wv:[&@slashn{distance:10,locked:true,originalValue:946,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-mu:[&@slashn{distance:0,locked:true,originalValue:1081,targetComponent:mainPage,topToTop:946,type:BOTTOM_PARENT}&@slashn]&@slashn---WPht0-17d:[&@slashn{distance:18,locked:true,originalValue:453,targetComponent:WRchTxt0-155m,topToTop:18,type:TOP_TOP}&@slashn{distance:10,locked:true,originalValue:590,targetComponent:WPht1-1o3,topToTop:155,type:BOTTOM_TOP}&@slashn]&@slashn---WRchTxt0-155m:[&@slashn{distance:7,locked:true,originalValue:145,targetComponent:WPht0-17d,topToTop:18,type:BOTTOM_BOTTOM}&@slashn{distance:17,locked:true,originalValue:590,targetComponent:WPht1-1o3,topToTop:137,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-1o3:[&@slashn{distance:10,locked:true,originalValue:801,targetComponent:WPht2-o8d,topToTop:211,type:BOTTOM_TOP}&@slashn{distance:10,locked:true,originalValue:801,targetComponent:WPht3-8wv,topToTop:211,type:BOTTOM_TOP}&@slashn{distance:26,locked:true,originalValue:616,targetComponent:WRchTxt1-lg5,topToTop:26,type:TOP_TOP}&@slashn]&@slashn---WRchTxt1-lg5:[&@slashn{distance:40,locked:true,originalValue:201,targetComponent:WPht1-1o3,topToTop:26,type:BOTTOM_BOTTOM}&@slashn{distance:50,locked:true,originalValue:801,targetComponent:WPht2-o8d,topToTop:185,type:BOTTOM_TOP}&@slashn{distance:50,locked:true,originalValue:801,targetComponent:WPht3-8wv,topToTop:185,type:BOTTOM_TOP}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                                            window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);
                                        });
                                    });
                                });
                            });
                        });
                    }); //it

                    //PASS
                    it("+ adding a new component on top of an existing component should not treat the two as composition", function () {
                        var componentsToAddStringified = '[{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht0-ljs","styleId":"wp1","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":500,"y":40,"width":250,"height":190,"scale":1,"rotationInDegrees":0,"anchors":[{"type":"TOP_TOP","targetComponent":"WPht1-e57","locked":true,"distance":45,"topToTop":45,"originalValue":85},{"type":"BOTTOM_TOP","targetComponent":"WPht0-mu","locked":false,"distance":210,"topToTop":400,"originalValue":440}]},"data":{"type":"Image","uri":"bafadadbe810eba6c2d754437f3164ca.jpg","title":"","description":"","width":1500,"height":998,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null},"dataRefs":{},"dataId":"c1nas","props":{"type":"WPhotoProperties","displayMode":"fill"},"propsId":"WPht0-ljs"}]';
                        window.mobileEditorUIDriver.addComponentsToPage(componentsToAddStringified, function () {
                            window.mobileEditorUIDriver.switchToMobileEditor(function () {
                                var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","SldShwGllry0-hsf","WPht1-e57","WPht2-1dvb","WPht1-13z5","WPht2-o8d","WPht3-8wv","WPht0-mu","WPht0-ljs"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---SldShwGllry0-hsf,&@slashn---WPht1-e57,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht2-o8d,&@slashn---WPht3-8wv,&@slashn---WPht0-mu,&@slashn---WPht0-ljs&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:958}&@slashn---SldShwGllry0-hsf:{x:20,y:10,width:280,height:172}&@slashn---WPht1-e57:{x:20,y:415,width:280,height:63}&@slashn---WPht2-1dvb:{x:111,y:568,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:488,width:223,height:137}&@slashn---WPht2-o8d:{x:47,y:658,width:100,height:135}&@slashn---WPht3-8wv:{x:174,y:658,width:100,height:135}&@slashn---WPht0-mu:{x:110,y:803,width:100,height:135}&@slashn---WPht0-ljs:{x:20,y:192,width:280,height:213}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:1075,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:958}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:958}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---SldShwGllry0-hsf:[&@slashn{distance:10,locked:true,originalValue:192,targetComponent:WPht0-ljs,topToTop:182,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:488,targetComponent:WPht1-13z5,topToTop:73,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:10,locked:true,originalValue:658,targetComponent:WPht2-o8d,topToTop:90,type:BOTTOM_TOP}&@slashn{distance:10,locked:true,originalValue:658,targetComponent:WPht3-8wv,topToTop:90,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:568,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-o8d:[&@slashn{distance:10,locked:true,originalValue:803,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht3-8wv:[&@slashn{distance:10,locked:true,originalValue:803,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-mu:[&@slashn{distance:0,locked:true,originalValue:938,targetComponent:mainPage,topToTop:803,type:BOTTOM_PARENT}&@slashn]&@slashn---WPht0-ljs:[&@slashn{distance:10,locked:true,originalValue:415,targetComponent:WPht1-e57,topToTop:223,type:BOTTOM_TOP}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                                window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);
                            });
                        });
                    }); //it

                }); //describe addition of multiple components
            }); //describe passing tests

            describe('Failing tests', function () {

            }); //describe failing tests

        }); //describe component addition

        describe("Hide and Readd", function () {

            //PASS
            it('+ top component is hidden, then readded', function () {
                window.mobileEditorUIDriver.switchToMobileEditor(function () {
                    window.mobileEditorUIDriver.deleteComponent('SldShwGllry0-hsf');

                    var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","WPht1-e57","WPht2-1dvb","WPht1-13z5","WPht2-o8d","WPht3-8wv","WPht0-mu"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---WPht1-e57,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht2-o8d,&@slashn---WPht3-8wv,&@slashn---WPht0-mu&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:553}&@slashn---WPht1-e57:{x:20,y:10,width:280,height:63}&@slashn---WPht2-1dvb:{x:111,y:163,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:83,width:223,height:137}&@slashn---WPht2-o8d:{x:47,y:253,width:100,height:135}&@slashn---WPht3-8wv:{x:174,y:253,width:100,height:135}&@slashn---WPht0-mu:{x:110,y:398,width:100,height:135}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:670,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:553}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:553}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:83,targetComponent:WPht1-13z5,topToTop:73,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:10,locked:true,originalValue:253,targetComponent:WPht3-8wv,topToTop:90,type:BOTTOM_TOP}&@slashn{distance:10,locked:true,originalValue:253,targetComponent:WPht2-o8d,topToTop:90,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:163,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-o8d:[&@slashn{distance:10,locked:true,originalValue:398,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht3-8wv:[&@slashn{distance:10,locked:true,originalValue:398,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-mu:[&@slashn{distance:0,locked:false,originalValue:533,targetComponent:mainPage,topToTop:398,type:BOTTOM_PARENT}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                    window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);

                    window.mobileEditorUIDriver.readdComponentToCurrentPage('SldShwGllry0-hsf', function () {
                        var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","WPht1-e57","WPht2-1dvb","WPht1-13z5","WPht2-o8d","WPht3-8wv","WPht0-mu","SldShwGllry0-hsf"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---WPht1-e57,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht2-o8d,&@slashn---WPht3-8wv,&@slashn---WPht0-mu,&@slashn---SldShwGllry0-hsf&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:735}&@slashn---WPht1-e57:{x:20,y:192,width:280,height:63}&@slashn---WPht2-1dvb:{x:111,y:345,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:265,width:223,height:137}&@slashn---WPht2-o8d:{x:47,y:435,width:100,height:135}&@slashn---WPht3-8wv:{x:174,y:435,width:100,height:135}&@slashn---WPht0-mu:{x:110,y:580,width:100,height:135}&@slashn---SldShwGllry0-hsf:{x:20,y:10,width:280,height:172}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:852,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:735}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:735}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:265,targetComponent:WPht1-13z5,topToTop:73,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:10,locked:true,originalValue:435,targetComponent:WPht2-o8d,topToTop:90,type:BOTTOM_TOP}&@slashn{distance:10,locked:true,originalValue:435,targetComponent:WPht3-8wv,topToTop:90,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:345,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-o8d:[&@slashn{distance:10,locked:true,originalValue:580,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht3-8wv:[&@slashn{distance:10,locked:true,originalValue:580,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-mu:[&@slashn{distance:0,locked:true,originalValue:715,targetComponent:mainPage,topToTop:580,type:BOTTOM_PARENT}&@slashn]&@slashn---SldShwGllry0-hsf:[&@slashn{distance:10,locked:true,originalValue:192,targetComponent:WPht1-e57,topToTop:182,type:BOTTOM_TOP}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                        window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);
                    });
                });
            }); //it

            //PASS
            it('+ middle component which is single in line is hidden, then readded', function () {
                window.mobileEditorUIDriver.switchToMobileEditor(function () {
                    window.mobileEditorUIDriver.deleteComponent('WPht1-e57');

                    var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","SldShwGllry0-hsf","WPht2-1dvb","WPht1-13z5","WPht2-o8d","WPht3-8wv","WPht0-mu"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---SldShwGllry0-hsf,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht2-o8d,&@slashn---WPht3-8wv,&@slashn---WPht0-mu&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:662}&@slashn---SldShwGllry0-hsf:{x:20,y:10,width:280,height:172}&@slashn---WPht2-1dvb:{x:111,y:272,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:192,width:223,height:137}&@slashn---WPht2-o8d:{x:47,y:362,width:100,height:135}&@slashn---WPht3-8wv:{x:174,y:362,width:100,height:135}&@slashn---WPht0-mu:{x:110,y:507,width:100,height:135}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:779,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:662}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:662}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---SldShwGllry0-hsf:[&@slashn{distance:10,locked:true,originalValue:192,targetComponent:WPht1-13z5,topToTop:182,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:10,locked:true,originalValue:362,targetComponent:WPht3-8wv,topToTop:90,type:BOTTOM_TOP}&@slashn{distance:10,locked:true,originalValue:362,targetComponent:WPht2-o8d,topToTop:90,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:272,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-o8d:[&@slashn{distance:10,locked:true,originalValue:507,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht3-8wv:[&@slashn{distance:10,locked:true,originalValue:507,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-mu:[&@slashn{distance:0,locked:false,originalValue:642,targetComponent:mainPage,topToTop:507,type:BOTTOM_PARENT}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                    window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);
                    window.mobileEditorUIDriver.readdComponentToCurrentPage('WPht1-e57', function () {
                        var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","SldShwGllry0-hsf","WPht2-1dvb","WPht1-13z5","WPht2-o8d","WPht3-8wv","WPht0-mu","WPht1-e57"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---SldShwGllry0-hsf,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht2-o8d,&@slashn---WPht3-8wv,&@slashn---WPht0-mu,&@slashn---WPht1-e57&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:735}&@slashn---SldShwGllry0-hsf:{x:20,y:10,width:280,height:172}&@slashn---WPht2-1dvb:{x:111,y:345,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:265,width:223,height:137}&@slashn---WPht2-o8d:{x:47,y:435,width:100,height:135}&@slashn---WPht3-8wv:{x:174,y:435,width:100,height:135}&@slashn---WPht0-mu:{x:110,y:580,width:100,height:135}&@slashn---WPht1-e57:{x:20,y:192,width:280,height:63}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:852,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:735}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:735}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---SldShwGllry0-hsf:[&@slashn{distance:10,locked:true,originalValue:192,targetComponent:WPht1-e57,topToTop:182,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:10,locked:true,originalValue:435,targetComponent:WPht2-o8d,topToTop:90,type:BOTTOM_TOP}&@slashn{distance:10,locked:true,originalValue:435,targetComponent:WPht3-8wv,topToTop:90,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:345,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-o8d:[&@slashn{distance:10,locked:true,originalValue:580,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht3-8wv:[&@slashn{distance:10,locked:true,originalValue:580,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-mu:[&@slashn{distance:0,locked:true,originalValue:715,targetComponent:mainPage,topToTop:580,type:BOTTOM_PARENT}&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:265,targetComponent:WPht1-13z5,topToTop:73,type:BOTTOM_TOP}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                        window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);
                    });
                });
            }); //it

            //PASS
            it('+ bottom component is hidden, then readded', function () {
                window.mobileEditorUIDriver.switchToMobileEditor(function () {
                    window.mobileEditorUIDriver.deleteComponent("WPht0-mu");

                    var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","SldShwGllry0-hsf","WPht1-e57","WPht2-1dvb","WPht1-13z5","WPht2-o8d","WPht3-8wv"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---SldShwGllry0-hsf,&@slashn---WPht1-e57,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht2-o8d,&@slashn---WPht3-8wv&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:590}&@slashn---SldShwGllry0-hsf:{x:20,y:10,width:280,height:172}&@slashn---WPht1-e57:{x:20,y:192,width:280,height:63}&@slashn---WPht2-1dvb:{x:111,y:345,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:265,width:223,height:137}&@slashn---WPht2-o8d:{x:47,y:435,width:100,height:135}&@slashn---WPht3-8wv:{x:174,y:435,width:100,height:135}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:707,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:590}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:590}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---SldShwGllry0-hsf:[&@slashn{distance:10,locked:true,originalValue:192,targetComponent:WPht1-e57,topToTop:182,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:265,targetComponent:WPht1-13z5,topToTop:73,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:10,locked:true,originalValue:435,targetComponent:WPht3-8wv,topToTop:90,type:BOTTOM_TOP}&@slashn{distance:10,locked:true,originalValue:435,targetComponent:WPht2-o8d,topToTop:90,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:345,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-o8d:[&@slashn{distance:0,locked:false,originalValue:570,targetComponent:mainPage,topToTop:435,type:BOTTOM_PARENT}&@slashn]&@slashn---WPht3-8wv:[&@slashn{distance:0,locked:false,originalValue:570,targetComponent:mainPage,topToTop:435,type:BOTTOM_PARENT}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                    window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);
                    window.mobileEditorUIDriver.readdComponentToCurrentPage("WPht0-mu", function () {
                        var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","SldShwGllry0-hsf","WPht1-e57","WPht2-1dvb","WPht1-13z5","WPht2-o8d","WPht3-8wv","WPht0-mu"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---SldShwGllry0-hsf,&@slashn---WPht1-e57,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht2-o8d,&@slashn---WPht3-8wv,&@slashn---WPht0-mu&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:735}&@slashn---SldShwGllry0-hsf:{x:20,y:10,width:280,height:172}&@slashn---WPht1-e57:{x:20,y:192,width:280,height:63}&@slashn---WPht2-1dvb:{x:111,y:345,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:265,width:223,height:137}&@slashn---WPht2-o8d:{x:47,y:435,width:100,height:135}&@slashn---WPht3-8wv:{x:174,y:435,width:100,height:135}&@slashn---WPht0-mu:{x:110,y:580,width:100,height:135}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:852,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:735}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:735}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---SldShwGllry0-hsf:[&@slashn{distance:10,locked:true,originalValue:192,targetComponent:WPht1-e57,topToTop:182,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:265,targetComponent:WPht1-13z5,topToTop:73,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:10,locked:true,originalValue:435,targetComponent:WPht3-8wv,topToTop:90,type:BOTTOM_TOP}&@slashn{distance:10,locked:true,originalValue:435,targetComponent:WPht2-o8d,topToTop:90,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:345,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-o8d:[&@slashn{distance:10,locked:true,originalValue:580,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht3-8wv:[&@slashn{distance:10,locked:true,originalValue:580,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-mu:[&@slashn{distance:0,locked:true,originalValue:715,targetComponent:mainPage,topToTop:580,type:BOTTOM_PARENT}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                        window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);

                    });
                });
            }); //it

            //PASS
            it('+ container with components is hidden (should hide children as well), then readded (should unhide only container)', function () {

                //add container:
                window.mobileEditorUIDriver.selectAllPageComponents();
                window.mobileEditorUIDriver.moveResizeComponent("SELECTED_COMPONENT", {y: 450, enforceAnchors: true});
                var componentsToAddStringified = '[{"componentType":"mobile.core.components.Container","type":"Container","id":"Cntnr0-97e","styleId":"c4","skin":"wysiwyg.viewer.skins.area.RectangleArea","layout":{"x":320,"y":55,"width":350,"height":250,"scale":1,"rotationInDegrees":0,"anchors":[{"type":"BOTTOM_TOP","targetComponent":"SldShwGllry0-hsf","locked":false,"distance":100,"topToTop":350,"originalValue":405},{"type":"BOTTOM_TOP","targetComponent":"WPht1-e57","locked":false,"distance":170,"topToTop":420,"originalValue":475}]},"components":[]}]';
                window.mobileEditorUIDriver.addComponentsToPage(componentsToAddStringified, function () {
                    window.mobileEditorUIDriver.moveResizeComponent("SELECTED_COMPONENT", {x: 350, y: 50, updateLayout: true});

                    window.mobileEditorUIDriver.switchToMobileEditor(function () {

                        window.mobileEditorUIDriver.attachToContainer('Cntnr0-97e', "WPht2-o8d");
                        window.mobileEditorUIDriver.attachToContainer('Cntnr0-97e', "WPht3-8wv", {x: 140, y: 0});
                        window.mobileEditorUIDriver.deleteComponent("Cntnr0-97e");
                        var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","SldShwGllry0-hsf","WPht1-e57","WPht2-1dvb","WPht1-13z5","WPht0-mu"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---SldShwGllry0-hsf,&@slashn---WPht1-e57,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht0-mu&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:945}&@slashn---SldShwGllry0-hsf:{x:20,y:10,width:280,height:172}&@slashn---WPht1-e57:{x:20,y:192,width:280,height:63}&@slashn---WPht2-1dvb:{x:111,y:345,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:265,width:223,height:137}&@slashn---WPht0-mu:{x:110,y:790,width:100,height:135}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:1062,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:945}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:945}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---SldShwGllry0-hsf:[&@slashn{distance:10,locked:true,originalValue:192,targetComponent:WPht1-e57,topToTop:182,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:265,targetComponent:WPht1-13z5,topToTop:73,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:365,locked:false,originalValue:790,targetComponent:WPht0-mu,topToTop:445,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:345,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-mu:[&@slashn{distance:0,locked:false,originalValue:925,targetComponent:mainPage,topToTop:790,type:BOTTOM_PARENT}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                        window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);

                        window.mobileEditorUIDriver.readdComponentToCurrentPage("Cntnr0-97e", function () {
                            var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","SldShwGllry0-hsf","WPht1-e57","WPht2-1dvb","WPht1-13z5","WPht0-mu","Cntnr0-97e"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---SldShwGllry0-hsf,&@slashn---WPht1-e57,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht0-mu,&@slashn---Cntnr0-97e&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:1155}&@slashn---SldShwGllry0-hsf:{x:20,y:220,width:280,height:172}&@slashn---WPht1-e57:{x:20,y:402,width:280,height:63}&@slashn---WPht2-1dvb:{x:111,y:555,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:475,width:223,height:137}&@slashn---WPht0-mu:{x:110,y:1000,width:100,height:135}&@slashn---Cntnr0-97e:{x:20,y:10,width:280,height:200}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:1272,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:1155}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:1155}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---SldShwGllry0-hsf:[&@slashn{distance:10,locked:true,originalValue:402,targetComponent:WPht1-e57,topToTop:182,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:475,targetComponent:WPht1-13z5,topToTop:73,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:365,locked:false,originalValue:1000,targetComponent:WPht0-mu,topToTop:445,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:555,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-mu:[&@slashn{distance:0,locked:true,originalValue:1135,targetComponent:mainPage,topToTop:1000,type:BOTTOM_PARENT}&@slashn]&@slashn---Cntnr0-97e:[&@slashn{distance:10,locked:true,originalValue:220,targetComponent:SldShwGllry0-hsf,topToTop:210,type:BOTTOM_TOP}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                            window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);
                        });
                    });

                });
            }); //it

        }); //describe hide and readd

        describe("Tiny Menu", function () {

            //PASS
            it("+ hiding tiny menu, and readding it, should work", function () {
                window.mobileEditorUIDriver.switchToMobileEditor(function () {
                    window.mobileEditorUIDriver.deleteComponent("TINY_MENU");
                    window.mobileEditorUIDriver.readdComponentToMasterPage("TINY_MENU", function () {
                        expect(W.Preview.getCompByID("TINY_MENU")).not.toBeUndefined();
                        var hiddenItemList = W.Preview.getMultiViewersHandler().getViewerModePageDeletedComponents('masterPage', Constants.ViewerTypesParams.TYPES.MOBILE);
                        expect(hiddenItemList).not.toContain("TINY_MENU");
                    });
                });
            });

            //PASS
            it("+ when hiding tiny menu, and switching back and forth from and to the mobile editor, the tiny menu should stay hidden", function () {
                window.mobileEditorUIDriver.switchToMobileEditor(function () {
                    window.mobileEditorUIDriver.deleteComponent("TINY_MENU");
                    window.mobileEditorUIDriver.switchToDesktopEditor();
                    window.mobileEditorUIDriver.switchToMobileEditor(function () {
                        expect(W.Preview.getCompByID("TINY_MENU")).toBeUndefined();
                        var hiddenItemList = W.Preview.getMultiViewersHandler().getViewerModePageDeletedComponents('masterPage', Constants.ViewerTypesParams.TYPES.MOBILE);
                        expect(hiddenItemList).toContain("TINY_MENU");
                    });
                });
            });

        }); //describe tinyMenu


        describe("Registrar", function () {
            it("+ addition of not recommended component should not be merged to mobile", function () {
                var componentsToAddStringified = '[{"componentType":"wysiwyg.viewer.components.VerticalLine","type":"Component","id":"VrtclLn0-3pd","styleId":"vl1","skin":"wysiwyg.viewer.skins.line.VerticalSolidLine","layout":{"x":795,"y":215,"width":5,"height":350,"scale":1,"rotationInDegrees":0,"anchors":[{"type":"BOTTOM_PARENT","targetComponent":"mainPage","locked":false,"distance":15,"topToTop":215,"originalValue":580}]}}]';
                window.mobileEditorUIDriver.addComponentsToPage(componentsToAddStringified, function () {
                    window.mobileEditorUIDriver.switchToMobileEditor(function () {
                        expect(W.Preview.getCompByID("VrtclLn0-3pd")).toBeUndefined();
                        var currentPageId = W.Preview.getPreviewManagers().Viewer.getCurrentPageId();
                        var hiddenItemList = W.Preview.getMultiViewersHandler().getViewerModePageDeletedComponents(currentPageId, Constants.ViewerTypesParams.TYPES.MOBILE);
                        expect(hiddenItemList).toContain("VrtclLn0-3pd");
                    });
                });
            });//it

            it("+ unhide of not recommended component should be added to mobile", function () {
                var componentsToAddStringified = '[{"componentType":"wysiwyg.viewer.components.VerticalLine","type":"Component","id":"VrtclLn0-3pd","styleId":"vl1","skin":"wysiwyg.viewer.skins.line.VerticalSolidLine","layout":{"x":795,"y":215,"width":5,"height":350,"scale":1,"rotationInDegrees":0,"anchors":[{"type":"BOTTOM_PARENT","targetComponent":"mainPage","locked":false,"distance":15,"topToTop":215,"originalValue":580}]}}]';
                window.mobileEditorUIDriver.addComponentsToPage(componentsToAddStringified, function () {
                    window.mobileEditorUIDriver.switchToMobileEditor(function () {
                        window.mobileEditorUIDriver.readdComponentToCurrentPage("VrtclLn0-3pd", function () {
                            expect(W.Preview.getCompByID("VrtclLn0-3pd")).not.toBeUndefined();
                            var currentPageId = W.Preview.getPreviewManagers().Viewer.getCurrentPageId();
                            var hiddenItemList = W.Preview.getMultiViewersHandler().getViewerModePageDeletedComponents(currentPageId, Constants.ViewerTypesParams.TYPES.MOBILE);
                            expect(hiddenItemList).not.toContain("VrtclLn0-3pd");
                        });
                    });
                });
            });//it

            it("+ check that defining a component in the registrar as not-mobile-ready, prevents it to be merged and doesnt put it in the hidden list", function () {
                window.mobileEditorUIDriver.registerClassNameAsNonMobileReady('wysiwyg.viewer.components.AudioPlayer');

                var componentsToAddStringified = '[{"componentType":"wysiwyg.viewer.components.AudioPlayer","type":"Component","id":"dPlyr0-59o","styleId":"ap1","skin":"wysiwyg.viewer.skins.audioplayer.SimplePlayer","layout":{"x":45,"y":465,"width":40,"height":40,"scale":1,"rotationInDegrees":0,"anchors":[{"type":"BOTTOM_PARENT","targetComponent":"mainPage","locked":false,"distance":70,"topToTop":465,"originalValue":575}]},"data":{"type":"AudioPlayer","metaData":{"isPreset":true},"visible":true,"volume":100,"uri":"","autoPlay":false,"loop":false},"dataRefs":{},"dataId":"c1nki"}]';
                window.mobileEditorUIDriver.addComponentsToPage(componentsToAddStringified, function () {
                    window.mobileEditorUIDriver.switchToMobileEditor(function () {
                        window.mobileEditorUIDriver.clearLayoutAlgorithmRegistrarFromComponent("wysiwyg.viewer.components.AudioPlayer", 'isMobileFunc');
                        expect(W.Preview.getCompByID("dPlyr0-59o")).toBeUndefined();
                        var currentPageId = W.Preview.getPreviewManagers().Viewer.getCurrentPageId();
                        var hiddenItemList = W.Preview.getMultiViewersHandler().getViewerModePageDeletedComponents(currentPageId, Constants.ViewerTypesParams.TYPES.MOBILE);

                        expect(hiddenItemList).not.toContain("dPlyr0-59o");

                    });
                });
            });//it

            it("+ check that defining a component in the registrar as not-recommeneded, prevents it to be merged and put it in the hidden list", function () {
                window.mobileEditorUIDriver.registerClassNameAsNonMobileRecommended('wysiwyg.viewer.components.AudioPlayer');

                var componentsToAddStringified = '[{"componentType":"wysiwyg.viewer.components.AudioPlayer","type":"Component","id":"dPlyr0-59o","styleId":"ap1","skin":"wysiwyg.viewer.skins.audioplayer.SimplePlayer","layout":{"x":45,"y":465,"width":40,"height":40,"scale":1,"rotationInDegrees":0,"anchors":[{"type":"BOTTOM_PARENT","targetComponent":"mainPage","locked":false,"distance":70,"topToTop":465,"originalValue":575}]},"data":{"type":"AudioPlayer","metaData":{"isPreset":true},"visible":true,"volume":100,"uri":"","autoPlay":false,"loop":false},"dataRefs":{},"dataId":"c1nki"}]';
                window.mobileEditorUIDriver.addComponentsToPage(componentsToAddStringified, function () {
                    window.mobileEditorUIDriver.switchToMobileEditor(function () {
                        window.mobileEditorUIDriver.clearLayoutAlgorithmRegistrarFromComponent("wysiwyg.viewer.components.AudioPlayer", 'isMobileRecommendedFunc');
                        expect(W.Preview.getCompByID("dPlyr0-59o")).toBeUndefined();
                        var currentPageId = W.Preview.getPreviewManagers().Viewer.getCurrentPageId();
                        var hiddenItemList = W.Preview.getMultiViewersHandler().getViewerModePageDeletedComponents(currentPageId, Constants.ViewerTypesParams.TYPES.MOBILE);
                        expect(hiddenItemList).toContain("dPlyr0-59o");
                    });
                });
            });//it

        }); //describe registrar

        describe('Merges involving Containers', function () {
            beforeEach(function () {
                window.mobileEditorUIDriver.selectAllPageComponents();
                window.mobileEditorUIDriver.moveResizeComponent("SELECTED_COMPONENT", {y: 450, enforceAnchors: true});

                var componentsToAddStringified = '[{"componentType":"mobile.core.components.Container","type":"Container","id":"Cntnr0-97e","styleId":"c4","skin":"wysiwyg.viewer.skins.area.RectangleArea","layout":{"x":320,"y":55,"width":350,"height":250,"scale":1,"rotationInDegrees":0,"anchors":[{"type":"BOTTOM_TOP","targetComponent":"SldShwGllry0-hsf","locked":false,"distance":100,"topToTop":350,"originalValue":405},{"type":"BOTTOM_TOP","targetComponent":"WPht1-e57","locked":false,"distance":170,"topToTop":420,"originalValue":475}]},"components":[]}]';
                window.mobileEditorUIDriver.addComponentsToPage(componentsToAddStringified, function () {
                    window.mobileEditorUIDriver.moveResizeComponent("SELECTED_COMPONENT", {x: 350, y: 50, updateLayout: true});
                });
            });

            describe('When the container was not yet added to mobileEditor', function () {

                //PASS
                it('+ when a container is added with a component inside it, they should be added together in the mobileEditor', function () {
                    var componentsToAddStringified = '[{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht0-14tw","styleId":"wp1","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":85,"y":45,"width":100,"height":100,"scale":1,"rotationInDegrees":0,"anchors":[{"type":"BOTTOM_TOP","targetComponent":"SldShwGllry0-hsf","locked":false,"distance":260,"topToTop":360,"originalValue":405}]},"data":{"type":"Image","uri":"da9ed5_b0778a5091853ccb29f92196a017eb69.jpg","title":"uri.jpg","description":"","width":166,"height":119,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null},"dataRefs":{},"dataId":"c203","props":{"type":"WPhotoProperties","displayMode":"fill"},"propsId":"WPht0-14tw"}]';
                    window.mobileEditorUIDriver.addComponentsToPage(componentsToAddStringified, function () {
                        window.mobileEditorUIDriver.attachToContainer('Cntnr0-97e', "WPht0-14tw");

                        window.mobileEditorUIDriver.switchToMobileEditor(function () {
                            var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","SldShwGllry0-hsf","WPht1-e57","WPht2-1dvb","WPht1-13z5","WPht2-o8d","WPht3-8wv","WPht0-mu","Cntnr0-97e","WPht0-14tw"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---SldShwGllry0-hsf,&@slashn---WPht1-e57,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht2-o8d,&@slashn---WPht3-8wv,&@slashn---WPht0-mu,&@slashn---Cntnr0-97e:{&@slashn------WPht0-14tw&@slashn---}&@slashn&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:865}&@slashn---SldShwGllry0-hsf:{x:20,y:140,width:280,height:172}&@slashn---WPht1-e57:{x:20,y:322,width:280,height:63}&@slashn---WPht2-1dvb:{x:111,y:475,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:395,width:223,height:137}&@slashn---WPht2-o8d:{x:47,y:565,width:100,height:135}&@slashn---WPht3-8wv:{x:174,y:565,width:100,height:135}&@slashn---WPht0-mu:{x:110,y:710,width:100,height:135}&@slashn---Cntnr0-97e:{x:20,y:10,width:280,height:120}&@slashn------WPht0-14tw:{x:90,y:10,width:100,height:100}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:982,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:865}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:865}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---SldShwGllry0-hsf:[&@slashn{distance:10,locked:true,originalValue:322,targetComponent:WPht1-e57,topToTop:182,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:395,targetComponent:WPht1-13z5,topToTop:73,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:10,locked:true,originalValue:565,targetComponent:WPht2-o8d,topToTop:90,type:BOTTOM_TOP}&@slashn{distance:10,locked:true,originalValue:565,targetComponent:WPht3-8wv,topToTop:90,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:475,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-o8d:[&@slashn{distance:10,locked:true,originalValue:710,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht3-8wv:[&@slashn{distance:10,locked:true,originalValue:710,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-mu:[&@slashn{distance:0,locked:true,originalValue:845,targetComponent:mainPage,topToTop:710,type:BOTTOM_PARENT}&@slashn]&@slashn---Cntnr0-97e:[&@slashn{distance:10,locked:true,originalValue:140,targetComponent:SldShwGllry0-hsf,topToTop:130,type:BOTTOM_TOP}&@slashn]&@slashn------WPht0-14tw:[&@slashn{distance:10,locked:true,originalValue:120,targetComponent:Cntnr0-97e,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                            window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);
                        });
                    });
                });

                //PASS
                it('+ when an existing component is attached to the new container, the existing component should be in place, and the container added separately', function () {
                    window.mobileEditorUIDriver.attachToContainer('Cntnr0-97e', "WPht0-mu");

                    window.mobileEditorUIDriver.switchToMobileEditor(function () {
                        var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","SldShwGllry0-hsf","WPht1-e57","WPht2-1dvb","WPht1-13z5","WPht2-o8d","WPht3-8wv","Cntnr0-97e","WPht0-mu"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---SldShwGllry0-hsf,&@slashn---WPht1-e57,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht2-o8d,&@slashn---WPht3-8wv,&@slashn---Cntnr0-97e:{&@slashn------WPht0-mu&@slashn---}&@slashn&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:755}&@slashn---SldShwGllry0-hsf:{x:20,y:175,width:280,height:172}&@slashn---WPht1-e57:{x:20,y:357,width:280,height:63}&@slashn---WPht2-1dvb:{x:111,y:510,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:430,width:223,height:137}&@slashn---WPht2-o8d:{x:47,y:600,width:100,height:135}&@slashn---WPht3-8wv:{x:174,y:600,width:100,height:135}&@slashn---Cntnr0-97e:{x:20,y:10,width:280,height:155}&@slashn------WPht0-mu:{x:90,y:10,width:100,height:135}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:872,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:755}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:755}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---SldShwGllry0-hsf:[&@slashn{distance:10,locked:true,originalValue:357,targetComponent:WPht1-e57,topToTop:182,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:430,targetComponent:WPht1-13z5,topToTop:73,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:10,locked:true,originalValue:600,targetComponent:WPht2-o8d,topToTop:90,type:BOTTOM_TOP}&@slashn{distance:10,locked:true,originalValue:600,targetComponent:WPht3-8wv,topToTop:90,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:510,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-o8d:[&@slashn{distance:0,locked:true,originalValue:735,targetComponent:mainPage,topToTop:600,type:BOTTOM_PARENT}&@slashn]&@slashn---WPht3-8wv:[&@slashn{distance:0,locked:true,originalValue:735,targetComponent:mainPage,topToTop:600,type:BOTTOM_PARENT}&@slashn]&@slashn---Cntnr0-97e:[&@slashn{distance:10,locked:true,originalValue:175,targetComponent:SldShwGllry0-hsf,topToTop:165,type:BOTTOM_TOP}&@slashn]&@slashn------WPht0-mu:[&@slashn{distance:10,locked:true,originalValue:155,targetComponent:Cntnr0-97e,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                        window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);
                    });
                }); //it


                //PASS
                it('+ when several existing components are attached to the new container, they should be together in the mobileEditor', function () {
                    window.mobileEditorUIDriver.attachToContainer('Cntnr0-97e', "WPht0-mu");
                    window.mobileEditorUIDriver.attachToContainer('Cntnr0-97e', "WPht1-e57", {x: 150, y: 150});

                    window.mobileEditorUIDriver.switchToMobileEditor(function () {
                        var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","SldShwGllry0-hsf","WPht2-1dvb","WPht1-13z5","WPht2-o8d","WPht3-8wv","Cntnr0-97e","WPht0-mu","WPht1-e57"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---SldShwGllry0-hsf,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht2-o8d,&@slashn---WPht3-8wv,&@slashn---Cntnr0-97e:{&@slashn------WPht0-mu,&@slashn------WPht1-e57&@slashn---}&@slashn&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:751}&@slashn---SldShwGllry0-hsf:{x:20,y:244,width:280,height:172}&@slashn---WPht2-1dvb:{x:111,y:506,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:426,width:223,height:137}&@slashn---WPht2-o8d:{x:47,y:596,width:100,height:135}&@slashn---WPht3-8wv:{x:174,y:596,width:100,height:135}&@slashn---Cntnr0-97e:{x:20,y:10,width:280,height:224}&@slashn------WPht0-mu:{x:90,y:10,width:100,height:135}&@slashn------WPht1-e57:{x:10,y:155,width:260,height:59}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:841,width:320,height:50}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:60}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:80,width:320,height:751}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:751}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---SldShwGllry0-hsf:[&@slashn{distance:10,locked:true,originalValue:426,targetComponent:WPht1-13z5,topToTop:182,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:10,locked:true,originalValue:596,targetComponent:WPht2-o8d,topToTop:90,type:BOTTOM_TOP}&@slashn{distance:10,locked:true,originalValue:596,targetComponent:WPht3-8wv,topToTop:90,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:506,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-o8d:[&@slashn{distance:0,locked:true,originalValue:731,targetComponent:mainPage,topToTop:596,type:BOTTOM_PARENT}&@slashn]&@slashn---WPht3-8wv:[&@slashn{distance:0,locked:true,originalValue:731,targetComponent:mainPage,topToTop:596,type:BOTTOM_PARENT}&@slashn]&@slashn---Cntnr0-97e:[&@slashn{distance:10,locked:true,originalValue:244,targetComponent:SldShwGllry0-hsf,topToTop:234,type:BOTTOM_TOP}&@slashn]&@slashn------WPht0-mu:[&@slashn{distance:110,locked:false,originalValue:685,targetComponent:mainPage,topToTop:440,type:BOTTOM_PARENT}&@slashn]&@slashn------WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:224,targetComponent:Cntnr0-97e,topToTop:155,type:BOTTOM_PARENT}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:70,targetComponent:PAGES_CONTAINER,topToTop:60,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:0,locked:true,originalValue:50,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:675,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                        window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);
                    });
                }); //it

                //PASS
                it('+ when existing non-mobile component is attached to the new container, it should be omitted in the mobileEditor', function () {
                    var menuData = '[{"componentType":"wysiwyg.viewer.components.menus.DropDownMenu","type":"Component","id":"DrpDwnMn1-7oh","styleId":"ddm2","skin":"wysiwyg.viewer.skins.dropmenu.SolidColorMenuNSkin","layout":{"x":880,"y":20,"width":80,"height":100,"scale":1,"rotationInDegrees":0,"anchors":[{"type":"BOTTOM_PARENT","targetComponent":"mainPage","locked":false,"distance":455,"topToTop":20,"originalValue":575}]},"uID":"#MAIN_MENU","props":{"type":"HorizontalMenuProperties","alignButtons":"center","alignText":"center","moreButtonLabel":"More","moreItemHeight":15,"stretchButtonsToMenuWidth":true,"sameWidthButtons":false},"propsId":"DrpDwnMn1-7oh"}]';
                    window.mobileEditorUIDriver.addComponentsToPage(menuData, function () {
                        window.mobileEditorUIDriver.attachToContainer('Cntnr0-97e', "DrpDwnMn1-7oh");
                        window.mobileEditorUIDriver.switchToMobileEditor(function () {
                            var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","SldShwGllry0-hsf","WPht1-e57","WPht2-1dvb","WPht1-13z5","WPht2-o8d","WPht3-8wv","WPht0-mu","Cntnr0-97e"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---SldShwGllry0-hsf,&@slashn---WPht1-e57,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht2-o8d,&@slashn---WPht3-8wv,&@slashn---WPht0-mu,&@slashn---Cntnr0-97e&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:945}&@slashn---SldShwGllry0-hsf:{x:20,y:220,width:280,height:172}&@slashn---WPht1-e57:{x:20,y:402,width:280,height:63}&@slashn---WPht2-1dvb:{x:111,y:555,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:475,width:223,height:137}&@slashn---WPht2-o8d:{x:47,y:645,width:100,height:135}&@slashn---WPht3-8wv:{x:174,y:645,width:100,height:135}&@slashn---WPht0-mu:{x:110,y:790,width:100,height:135}&@slashn---Cntnr0-97e:{x:20,y:10,width:280,height:200}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:1062,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:945}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:945}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---SldShwGllry0-hsf:[&@slashn{distance:10,locked:true,originalValue:402,targetComponent:WPht1-e57,topToTop:182,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:475,targetComponent:WPht1-13z5,topToTop:73,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:10,locked:true,originalValue:645,targetComponent:WPht2-o8d,topToTop:90,type:BOTTOM_TOP}&@slashn{distance:10,locked:true,originalValue:645,targetComponent:WPht3-8wv,topToTop:90,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:555,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-o8d:[&@slashn{distance:10,locked:true,originalValue:790,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht3-8wv:[&@slashn{distance:10,locked:true,originalValue:790,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-mu:[&@slashn{distance:0,locked:true,originalValue:925,targetComponent:mainPage,topToTop:790,type:BOTTOM_PARENT}&@slashn]&@slashn---Cntnr0-97e:[&@slashn{distance:10,locked:true,originalValue:220,targetComponent:SldShwGllry0-hsf,topToTop:210,type:BOTTOM_TOP}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                            window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);
                        });
                    });
                }); //it

                //PASS
                it('+ when existing component hidden in mobile is attached to the new container, it should stay hidden in the mobileEditor', function () {
                    window.mobileEditorUIDriver.switchToMobileEditor(function () {
                        window.mobileEditorUIDriver.deleteComponent('SldShwGllry0-hsf');
                        window.mobileEditorUIDriver.switchToDesktopEditor();
                        window.mobileEditorUIDriver.attachToContainer('Cntnr0-97e', 'SldShwGllry0-hsf');
                        window.mobileEditorUIDriver.switchToMobileEditor(function () {
                            var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","WPht1-e57","WPht2-1dvb","WPht1-13z5","WPht2-o8d","WPht3-8wv","WPht0-mu","Cntnr0-97e"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---WPht1-e57,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht2-o8d,&@slashn---WPht3-8wv,&@slashn---WPht0-mu,&@slashn---Cntnr0-97e&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:763}&@slashn---WPht1-e57:{x:20,y:220,width:280,height:63}&@slashn---WPht2-1dvb:{x:111,y:373,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:293,width:223,height:137}&@slashn---WPht2-o8d:{x:47,y:463,width:100,height:135}&@slashn---WPht3-8wv:{x:174,y:463,width:100,height:135}&@slashn---WPht0-mu:{x:110,y:608,width:100,height:135}&@slashn---Cntnr0-97e:{x:20,y:10,width:280,height:200}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:880,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:763}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:763}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:293,targetComponent:WPht1-13z5,topToTop:73,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:10,locked:true,originalValue:463,targetComponent:WPht3-8wv,topToTop:90,type:BOTTOM_TOP}&@slashn{distance:10,locked:true,originalValue:463,targetComponent:WPht2-o8d,topToTop:90,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:373,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-o8d:[&@slashn{distance:10,locked:true,originalValue:608,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht3-8wv:[&@slashn{distance:10,locked:true,originalValue:608,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-mu:[&@slashn{distance:0,locked:false,originalValue:743,targetComponent:mainPage,topToTop:608,type:BOTTOM_PARENT}&@slashn]&@slashn---Cntnr0-97e:[&@slashn{distance:10,locked:true,originalValue:220,targetComponent:WPht1-e57,topToTop:210,type:BOTTOM_TOP}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                            window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);
                        });
                    });
                }); //it

            }); //describe when the container was not yet added to mobile


            describe('When the container already exists in the mobileEditor', function () {
                beforeEach(function () {
                    window.mobileEditorUIDriver.switchToDesktopEditor();
                    window.mobileEditorUIDriver.switchToMobileEditor(function () {
                        window.mobileEditorUIDriver.switchToDesktopEditor();
                    });
                });

                //PASS
                it('+ attaching an existing component to a container, will not change anything in the mobileEditor', function () {
                    window.mobileEditorUIDriver.switchToMobileEditor(function () {
                        var siteDataBeforeAttachment = window.structureComparisonDriver.parseAllTemplateRequiredDataForTest();
                        window.mobileEditorUIDriver.switchToDesktopEditor();
                        window.mobileEditorUIDriver.attachToContainer('Cntnr0-97e', "WPht2-o8d");
                        window.mobileEditorUIDriver.switchToMobileEditor(function () {
                            var siteDataAfterAttachment = window.structureComparisonDriver.parseAllTemplateRequiredDataForTest();
                            expect(siteDataBeforeAttachment).toBe(siteDataAfterAttachment);
                        });
                    });
                });//it

                //PASS
                it('+ hiding a component inside a container in mobile, but there is another component in this container, will not shrink the container', function () {
                    window.mobileEditorUIDriver.switchToMobileEditor(function () {
                        window.mobileEditorUIDriver.attachToContainer('Cntnr0-97e', "WPht2-o8d");
                        window.mobileEditorUIDriver.attachToContainer('Cntnr0-97e', "WPht3-8wv", {x: 150});
                        window.mobileEditorUIDriver.deleteComponent("WPht2-o8d");
                        var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","SldShwGllry0-hsf","WPht1-e57","WPht2-1dvb","WPht1-13z5","WPht0-mu","Cntnr0-97e","WPht3-8wv"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---SldShwGllry0-hsf,&@slashn---WPht1-e57,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht0-mu,&@slashn---Cntnr0-97e:{&@slashn------WPht3-8wv&@slashn---}&@slashn&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:945}&@slashn---SldShwGllry0-hsf:{x:20,y:220,width:280,height:172}&@slashn---WPht1-e57:{x:20,y:402,width:280,height:63}&@slashn---WPht2-1dvb:{x:111,y:555,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:475,width:223,height:137}&@slashn---WPht0-mu:{x:110,y:790,width:100,height:135}&@slashn---Cntnr0-97e:{x:20,y:10,width:280,height:200}&@slashn------WPht3-8wv:{x:150,y:10,width:100,height:135}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:1062,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:945}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:945}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---SldShwGllry0-hsf:[&@slashn{distance:10,locked:true,originalValue:402,targetComponent:WPht1-e57,topToTop:182,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:475,targetComponent:WPht1-13z5,topToTop:73,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:155,locked:false,originalValue:790,targetComponent:WPht0-mu,topToTop:235,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:555,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-mu:[&@slashn{distance:0,locked:false,originalValue:925,targetComponent:mainPage,topToTop:790,type:BOTTOM_PARENT}&@slashn]&@slashn---Cntnr0-97e:[&@slashn{distance:10,locked:true,originalValue:220,targetComponent:SldShwGllry0-hsf,topToTop:210,type:BOTTOM_TOP}&@slashn]&@slashn------WPht3-8wv:[&@slashn{distance:55,locked:true,originalValue:200,targetComponent:Cntnr0-97e,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                        window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);
                    });
                });//it

                //PASS
                it('+ when adding a narrow new component to the container, it should add it to the container in the mobile too', function () {
                    var componentsToAddStringified = '[{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht0-14tw","styleId":"wp1","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":85,"y":45,"width":100,"height":100,"scale":1,"rotationInDegrees":0,"anchors":[{"type":"BOTTOM_TOP","targetComponent":"SldShwGllry0-hsf","locked":false,"distance":260,"topToTop":360,"originalValue":405}]},"data":{"type":"Image","uri":"da9ed5_b0778a5091853ccb29f92196a017eb69.jpg","title":"uri.jpg","description":"","width":166,"height":119,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null},"dataRefs":{},"dataId":"c203","props":{"type":"WPhotoProperties","displayMode":"fill"},"propsId":"WPht0-14tw"}]';
                    window.mobileEditorUIDriver.addComponentsToPage(componentsToAddStringified, function () {
                        window.mobileEditorUIDriver.attachToContainer('Cntnr0-97e', "WPht0-14tw");

                        window.mobileEditorUIDriver.switchToMobileEditor(function () {
                            var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","SldShwGllry0-hsf","WPht1-e57","WPht2-1dvb","WPht1-13z5","WPht2-o8d","WPht3-8wv","WPht0-mu","Cntnr0-97e","WPht0-14tw"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---SldShwGllry0-hsf,&@slashn---WPht1-e57,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht2-o8d,&@slashn---WPht3-8wv,&@slashn---WPht0-mu,&@slashn---Cntnr0-97e:{&@slashn------WPht0-14tw&@slashn---}&@slashn&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:945}&@slashn---SldShwGllry0-hsf:{x:20,y:220,width:280,height:172}&@slashn---WPht1-e57:{x:20,y:402,width:280,height:63}&@slashn---WPht2-1dvb:{x:111,y:555,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:475,width:223,height:137}&@slashn---WPht2-o8d:{x:47,y:645,width:100,height:135}&@slashn---WPht3-8wv:{x:174,y:645,width:100,height:135}&@slashn---WPht0-mu:{x:110,y:790,width:100,height:135}&@slashn---Cntnr0-97e:{x:20,y:10,width:280,height:200}&@slashn------WPht0-14tw:{x:90,y:10,width:100,height:100}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:1062,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:945}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:945}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---SldShwGllry0-hsf:[&@slashn{distance:10,locked:true,originalValue:402,targetComponent:WPht1-e57,topToTop:182,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:475,targetComponent:WPht1-13z5,topToTop:73,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:10,locked:true,originalValue:645,targetComponent:WPht2-o8d,topToTop:90,type:BOTTOM_TOP}&@slashn{distance:10,locked:true,originalValue:645,targetComponent:WPht3-8wv,topToTop:90,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:555,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-o8d:[&@slashn{distance:10,locked:true,originalValue:790,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht3-8wv:[&@slashn{distance:10,locked:true,originalValue:790,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-mu:[&@slashn{distance:0,locked:true,originalValue:925,targetComponent:mainPage,topToTop:790,type:BOTTOM_PARENT}&@slashn]&@slashn---Cntnr0-97e:[&@slashn{distance:10,locked:true,originalValue:220,targetComponent:SldShwGllry0-hsf,topToTop:210,type:BOTTOM_TOP}&@slashn]&@slashn------WPht0-14tw:[&@slashn{distance:90,locked:false,originalValue:200,targetComponent:Cntnr0-97e,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                            window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);
                        });
                    });
                });//it

                //PASS
                it('+ when adding a VERY wide new component to the container (wider than the container mobile width), it should add it to the container in the mobile too, and get full container width', function () {
                    var componentsToAddStringified = '[{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht0-14tw","styleId":"wp1","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":85,"y":45,"width":400,"height":100,"scale":1,"rotationInDegrees":0,"anchors":[{"type":"BOTTOM_TOP","targetComponent":"SldShwGllry0-hsf","locked":false,"distance":260,"topToTop":360,"originalValue":405}]},"data":{"type":"Image","uri":"da9ed5_b0778a5091853ccb29f92196a017eb69.jpg","title":"uri.jpg","description":"","width":166,"height":119,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null},"dataRefs":{},"dataId":"c203","props":{"type":"WPhotoProperties","displayMode":"fill"},"propsId":"WPht0-14tw"}]';
                    window.mobileEditorUIDriver.addComponentsToPage(componentsToAddStringified, function () {
                        window.mobileEditorUIDriver.attachToContainer('Cntnr0-97e', "WPht0-14tw");

                        window.mobileEditorUIDriver.switchToMobileEditor(function () {
                            var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","SldShwGllry0-hsf","WPht1-e57","WPht2-1dvb","WPht1-13z5","WPht2-o8d","WPht3-8wv","WPht0-mu","Cntnr0-97e","WPht0-14tw"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---SldShwGllry0-hsf,&@slashn---WPht1-e57,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht2-o8d,&@slashn---WPht3-8wv,&@slashn---WPht0-mu,&@slashn---Cntnr0-97e:{&@slashn------WPht0-14tw&@slashn---}&@slashn&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:945}&@slashn---SldShwGllry0-hsf:{x:20,y:220,width:280,height:172}&@slashn---WPht1-e57:{x:20,y:402,width:280,height:63}&@slashn---WPht2-1dvb:{x:111,y:555,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:475,width:223,height:137}&@slashn---WPht2-o8d:{x:47,y:645,width:100,height:135}&@slashn---WPht3-8wv:{x:174,y:645,width:100,height:135}&@slashn---WPht0-mu:{x:110,y:790,width:100,height:135}&@slashn---Cntnr0-97e:{x:20,y:10,width:280,height:200}&@slashn------WPht0-14tw:{x:10,y:10,width:260,height:65}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:1062,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:945}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:945}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---SldShwGllry0-hsf:[&@slashn{distance:10,locked:true,originalValue:402,targetComponent:WPht1-e57,topToTop:182,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:475,targetComponent:WPht1-13z5,topToTop:73,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:10,locked:true,originalValue:645,targetComponent:WPht2-o8d,topToTop:90,type:BOTTOM_TOP}&@slashn{distance:10,locked:true,originalValue:645,targetComponent:WPht3-8wv,topToTop:90,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:555,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-o8d:[&@slashn{distance:10,locked:true,originalValue:790,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht3-8wv:[&@slashn{distance:10,locked:true,originalValue:790,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-mu:[&@slashn{distance:0,locked:true,originalValue:925,targetComponent:mainPage,topToTop:790,type:BOTTOM_PARENT}&@slashn]&@slashn---Cntnr0-97e:[&@slashn{distance:10,locked:true,originalValue:220,targetComponent:SldShwGllry0-hsf,topToTop:210,type:BOTTOM_TOP}&@slashn]&@slashn------WPht0-14tw:[&@slashn{distance:125,locked:false,originalValue:200,targetComponent:Cntnr0-97e,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                            window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);

                        });
                    });
                });//it

                //PASS
                it('+ when adding a wide new component to the container, it should add it to the container in the mobile too, but though it is more than 50% of the container width, it is not a page, so it doesnt need to get full container width', function () {
                    var componentsToAddStringified = '[{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht0-14tw","styleId":"wp1","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":85,"y":45,"width":200,"height":100,"scale":1,"rotationInDegrees":0,"anchors":[{"type":"BOTTOM_TOP","targetComponent":"SldShwGllry0-hsf","locked":false,"distance":260,"topToTop":360,"originalValue":405}]},"data":{"type":"Image","uri":"da9ed5_b0778a5091853ccb29f92196a017eb69.jpg","title":"uri.jpg","description":"","width":166,"height":119,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null},"dataRefs":{},"dataId":"c203","props":{"type":"WPhotoProperties","displayMode":"fill"},"propsId":"WPht0-14tw"}]';
                    window.mobileEditorUIDriver.addComponentsToPage(componentsToAddStringified, function () {
                        window.mobileEditorUIDriver.attachToContainer('Cntnr0-97e', "WPht0-14tw");

                        window.mobileEditorUIDriver.switchToMobileEditor(function () {
                            var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","SldShwGllry0-hsf","WPht1-e57","WPht2-1dvb","WPht1-13z5","WPht2-o8d","WPht3-8wv","WPht0-mu","Cntnr0-97e","WPht0-14tw"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---SldShwGllry0-hsf,&@slashn---WPht1-e57,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht2-o8d,&@slashn---WPht3-8wv,&@slashn---WPht0-mu,&@slashn---Cntnr0-97e:{&@slashn------WPht0-14tw&@slashn---}&@slashn&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:945}&@slashn---SldShwGllry0-hsf:{x:20,y:220,width:280,height:172}&@slashn---WPht1-e57:{x:20,y:402,width:280,height:63}&@slashn---WPht2-1dvb:{x:111,y:555,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:475,width:223,height:137}&@slashn---WPht2-o8d:{x:47,y:645,width:100,height:135}&@slashn---WPht3-8wv:{x:174,y:645,width:100,height:135}&@slashn---WPht0-mu:{x:110,y:790,width:100,height:135}&@slashn---Cntnr0-97e:{x:20,y:10,width:280,height:200}&@slashn------WPht0-14tw:{x:40,y:10,width:200,height:100}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:1062,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:945}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:945}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---SldShwGllry0-hsf:[&@slashn{distance:10,locked:true,originalValue:402,targetComponent:WPht1-e57,topToTop:182,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:475,targetComponent:WPht1-13z5,topToTop:73,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:10,locked:true,originalValue:645,targetComponent:WPht2-o8d,topToTop:90,type:BOTTOM_TOP}&@slashn{distance:10,locked:true,originalValue:645,targetComponent:WPht3-8wv,topToTop:90,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:555,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-o8d:[&@slashn{distance:10,locked:true,originalValue:790,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht3-8wv:[&@slashn{distance:10,locked:true,originalValue:790,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-mu:[&@slashn{distance:0,locked:true,originalValue:925,targetComponent:mainPage,topToTop:790,type:BOTTOM_PARENT}&@slashn]&@slashn---Cntnr0-97e:[&@slashn{distance:10,locked:true,originalValue:220,targetComponent:SldShwGllry0-hsf,topToTop:210,type:BOTTOM_TOP}&@slashn]&@slashn------WPht0-14tw:[&@slashn{distance:90,locked:false,originalValue:200,targetComponent:Cntnr0-97e,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                            window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);
                        });
                    });
                });//it

                //PASS
                it('+ hiding a component inside a container in mobile, where there is no other component in this container, will shrink the container height to minimum (50px)', function () {
                    window.mobileEditorUIDriver.switchToMobileEditor(function () {
                        window.mobileEditorUIDriver.attachToContainer('Cntnr0-97e', "WPht2-o8d");
                        window.mobileEditorUIDriver.deleteComponent("WPht2-o8d");
                        var actualContainerHeight = W.Preview.getCompByID('Cntnr0-97e', "MOBILE").$logic.getHeight();
                        expect(actualContainerHeight).toBe(50);
                    });
                });//it

                //PASS
                it('+ if in mobile there is a component inside a container, but in desktop we deattach it and then deleting the container, the component in mobile will be visible', function () {
                    var componentsToAddStringified = '[{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht0-14tw","styleId":"wp1","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":85,"y":45,"width":200,"height":100,"scale":1,"rotationInDegrees":0,"anchors":[{"type":"BOTTOM_TOP","targetComponent":"SldShwGllry0-hsf","locked":false,"distance":260,"topToTop":360,"originalValue":405}]},"data":{"type":"Image","uri":"da9ed5_b0778a5091853ccb29f92196a017eb69.jpg","title":"uri.jpg","description":"","width":166,"height":119,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null},"dataRefs":{},"dataId":"c203","props":{"type":"WPhotoProperties","displayMode":"fill"},"propsId":"WPht0-14tw"}]';
                    window.mobileEditorUIDriver.addComponentsToPage(componentsToAddStringified, function () {
                        window.mobileEditorUIDriver.attachToContainer('Cntnr0-97e', "WPht0-14tw");

                        window.mobileEditorUIDriver.switchToMobileEditor(function () {
                            window.mobileEditorUIDriver.switchToDesktopEditor();
                            window.mobileEditorUIDriver.attachToContainer('mainPage', "WPht0-14tw");
                            window.mobileEditorUIDriver.deleteComponent("Cntnr0-97e");
                            window.mobileEditorUIDriver.switchToMobileEditor(function () {
                                expect(W.Preview.getCompByID("WPht0-14tw")).not.toBeUndefined();
                            });
                        });
                    });
                });//it


                describe("a container inside a container", function () {

                    beforeEach(function () {
                        var componentsToAddStringified = '[{"componentType":"mobile.core.components.Container","type":"Container","id":"Cntnr0-12rg","styleId":"c1","skin":"wysiwyg.viewer.skins.area.RectangleArea","layout":{"x":580,"y":555,"width":305,"height":215,"scale":1,"rotationInDegrees":0,"anchors":[{"type":"BOTTOM_PARENT","targetComponent":"mainPage","locked":false,"distance":235,"topToTop":555,"originalValue":1005}]},"components":[]}]';
                        window.mobileEditorUIDriver.addComponentsToPage(componentsToAddStringified, function () {
                            window.mobileEditorUIDriver.attachToContainer('Cntnr0-97e', "Cntnr0-12rg");
                            window.mobileEditorUIDriver.switchToMobileEditor(function () {
                                window.mobileEditorUIDriver.switchToDesktopEditor();
                            });
                        });
                    });

                    //PASS
                    it('+ when adding a new component to a container inside a container, it should add it to the inner container', function () {
                        var componentsToAddStringified = '[{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht0-14tw","styleId":"wp1","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":85,"y":45,"width":100,"height":100,"scale":1,"rotationInDegrees":0,"anchors":[{"type":"BOTTOM_TOP","targetComponent":"SldShwGllry0-hsf","locked":false,"distance":260,"topToTop":360,"originalValue":405}]},"data":{"type":"Image","uri":"da9ed5_b0778a5091853ccb29f92196a017eb69.jpg","title":"uri.jpg","description":"","width":166,"height":119,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null},"dataRefs":{},"dataId":"c203","props":{"type":"WPhotoProperties","displayMode":"fill"},"propsId":"WPht0-14tw"}]';
                        window.mobileEditorUIDriver.addComponentsToPage(componentsToAddStringified, function () {
                            window.mobileEditorUIDriver.attachToContainer("Cntnr0-12rg", "WPht0-14tw");

                            window.mobileEditorUIDriver.switchToMobileEditor(function () {
                                var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","SldShwGllry0-hsf","WPht1-e57","WPht2-1dvb","WPht1-13z5","WPht2-o8d","WPht3-8wv","WPht0-mu","Cntnr0-97e","Cntnr0-12rg","WPht0-14tw"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---SldShwGllry0-hsf,&@slashn---WPht1-e57,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht2-o8d,&@slashn---WPht3-8wv,&@slashn---WPht0-mu,&@slashn---Cntnr0-97e:{&@slashn------Cntnr0-12rg:{&@slashn---------WPht0-14tw&@slashn------}&@slashn&@slashn---}&@slashn&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:948}&@slashn---SldShwGllry0-hsf:{x:20,y:223,width:280,height:172}&@slashn---WPht1-e57:{x:20,y:405,width:280,height:63}&@slashn---WPht2-1dvb:{x:111,y:558,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:478,width:223,height:137}&@slashn---WPht2-o8d:{x:47,y:648,width:100,height:135}&@slashn---WPht3-8wv:{x:174,y:648,width:100,height:135}&@slashn---WPht0-mu:{x:110,y:793,width:100,height:135}&@slashn---Cntnr0-97e:{x:20,y:10,width:280,height:203}&@slashn------Cntnr0-12rg:{x:10,y:10,width:260,height:183}&@slashn---------WPht0-14tw:{x:80,y:10,width:100,height:100}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:1065,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:948}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:948}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---SldShwGllry0-hsf:[&@slashn{distance:10,locked:true,originalValue:402,targetComponent:WPht1-e57,topToTop:182,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:475,targetComponent:WPht1-13z5,topToTop:73,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:10,locked:true,originalValue:645,targetComponent:WPht2-o8d,topToTop:90,type:BOTTOM_TOP}&@slashn{distance:10,locked:true,originalValue:645,targetComponent:WPht3-8wv,topToTop:90,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:555,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-o8d:[&@slashn{distance:10,locked:true,originalValue:790,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht3-8wv:[&@slashn{distance:10,locked:true,originalValue:790,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-mu:[&@slashn{distance:0,locked:true,originalValue:925,targetComponent:mainPage,topToTop:790,type:BOTTOM_PARENT}&@slashn]&@slashn---Cntnr0-97e:[&@slashn{distance:10,locked:true,originalValue:220,targetComponent:SldShwGllry0-hsf,topToTop:210,type:BOTTOM_TOP}&@slashn]&@slashn------Cntnr0-12rg:[&@slashn{distance:10,locked:true,originalValue:203,targetComponent:Cntnr0-97e,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---------WPht0-14tw:[&@slashn{distance:73,locked:false,originalValue:183,targetComponent:Cntnr0-12rg,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                                window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);

                            });
                        });
                    });//it

                    //PASS
                    it('+ when adding a new component to a container inside a container, but the inner component is hidden in mobile, it should add it to the outer container', function () {
                        var componentsToAddStringified = '[{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht0-14tw","styleId":"wp1","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":85,"y":45,"width":100,"height":100,"scale":1,"rotationInDegrees":0,"anchors":[{"type":"BOTTOM_TOP","targetComponent":"SldShwGllry0-hsf","locked":false,"distance":260,"topToTop":360,"originalValue":405}]},"data":{"type":"Image","uri":"da9ed5_b0778a5091853ccb29f92196a017eb69.jpg","title":"uri.jpg","description":"","width":166,"height":119,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null},"dataRefs":{},"dataId":"c203","props":{"type":"WPhotoProperties","displayMode":"fill"},"propsId":"WPht0-14tw"}]';
                        window.mobileEditorUIDriver.switchToMobileEditor(function () {
                            window.mobileEditorUIDriver.deleteComponent("Cntnr0-12rg");
                            window.mobileEditorUIDriver.switchToDesktopEditor();
                            window.mobileEditorUIDriver.addComponentsToPage(componentsToAddStringified, function () {
                                window.mobileEditorUIDriver.sleep(600, function () {
                                    window.mobileEditorUIDriver.attachToContainer("Cntnr0-12rg", "WPht0-14tw");
                                    window.mobileEditorUIDriver.sleep(300, function () {
                                        window.mobileEditorUIDriver.switchToMobileEditor(function () {
                                            window.mobileEditorUIDriver.sleep(300, function () {
                                                var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage","SldShwGllry0-hsf","WPht1-e57","WPht2-1dvb","WPht1-13z5","WPht2-o8d","WPht3-8wv","WPht0-mu","Cntnr0-97e","WPht0-14tw"],"masterPage":["SITE_FOOTER","SITE_HEADER","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage:{&@slashn---SldShwGllry0-hsf,&@slashn---WPht1-e57,&@slashn---WPht2-1dvb,&@slashn---WPht1-13z5,&@slashn---WPht2-o8d,&@slashn---WPht3-8wv,&@slashn---WPht0-mu,&@slashn---Cntnr0-97e:{&@slashn------WPht0-14tw&@slashn---}&@slashn&@slashn}&@slashn","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:865}&@slashn---SldShwGllry0-hsf:{x:20,y:140,width:280,height:172}&@slashn---WPht1-e57:{x:20,y:322,width:280,height:63}&@slashn---WPht2-1dvb:{x:111,y:475,width:189,height:80}&@slashn---WPht1-13z5:{x:20,y:395,width:223,height:137}&@slashn---WPht2-o8d:{x:47,y:565,width:100,height:135}&@slashn---WPht3-8wv:{x:174,y:565,width:100,height:135}&@slashn---WPht0-mu:{x:110,y:710,width:100,height:135}&@slashn---Cntnr0-97e:{x:20,y:10,width:280,height:120}&@slashn------WPht0-14tw:{x:90,y:10,width:100,height:100}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:982,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:87}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:107,width:320,height:865}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:865}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn---SldShwGllry0-hsf:[&@slashn{distance:10,locked:true,originalValue:402,targetComponent:WPht1-e57,topToTop:182,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-e57:[&@slashn{distance:10,locked:true,originalValue:475,targetComponent:WPht1-13z5,topToTop:73,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-1dvb:[&@slashn{distance:10,locked:true,originalValue:645,targetComponent:WPht3-8wv,topToTop:90,type:BOTTOM_TOP}&@slashn{distance:10,locked:true,originalValue:645,targetComponent:WPht2-o8d,topToTop:90,type:BOTTOM_TOP}&@slashn]&@slashn---WPht1-13z5:[&@slashn{distance:-57,locked:true,originalValue:555,targetComponent:WPht2-1dvb,topToTop:80,type:BOTTOM_TOP}&@slashn]&@slashn---WPht2-o8d:[&@slashn{distance:10,locked:true,originalValue:790,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht3-8wv:[&@slashn{distance:10,locked:true,originalValue:790,targetComponent:WPht0-mu,topToTop:145,type:BOTTOM_TOP}&@slashn]&@slashn---WPht0-mu:[&@slashn{distance:0,locked:true,originalValue:925,targetComponent:mainPage,topToTop:790,type:BOTTOM_PARENT}&@slashn]&@slashn---Cntnr0-97e:[&@slashn{distance:10,locked:true,originalValue:223,targetComponent:SldShwGllry0-hsf,topToTop:213,type:BOTTOM_TOP}&@slashn]&@slashn------WPht0-14tw:[&@slashn{distance:10,locked:true,originalValue:120,targetComponent:Cntnr0-97e,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:107,targetComponent:PAGES_CONTAINER,topToTop:97,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:27,locked:true,originalValue:87,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:712,targetComponent:SITE_FOOTER,topToTop:605,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:595,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                                                window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);
                                            });
                                        });
                                    });
                                });
                            });
                        });
                    });//it

                }); // describe container inside container

            });

        }); //describe containers

    });

    describe("Master Page tests", function () {
        beforeEach(function () {

            //delete all components in page:
            window.mobileEditorUIDriver.switchToDesktopEditor();
            window.mobileEditorUIDriver.deleteAllCurrentPageComponents();
            window.mobileEditorUIDriver.deleteHeaderAndFooterComponents();

            var componentsToAddStringified = '[{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht2-j3i","styleId":"wp1","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":695,"y":200,"width":50,"height":40,"scale":1,"rotationInDegrees":0,"anchors":[{"type":"BOTTOM_PARENT","targetComponent":"SITE_HEADER","locked":true,"distance":25,"topToTop":200,"originalValue":265}]},"data":{"type":"Image","uri":"78d8d02385fedc4d1aabf31e0ac1b256.jpg","title":"","description":"","width":1024,"height":683,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null,"href":""},"dataRefs":{},"dataId":"cllj","props":{"type":"WPhotoProperties","displayMode":"fill","metaData":{}},"propsId":"czjm"},{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht1-1ci9","styleId":"wp1","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":620,"y":200,"width":50,"height":40,"scale":1,"rotationInDegrees":0,"anchors":[{"type":"BOTTOM_PARENT","targetComponent":"SITE_HEADER","locked":true,"distance":25,"topToTop":200,"originalValue":265}]},"data":{"type":"Image","uri":"f4c844ad746eb26fec238b0e5244e07b.jpg","title":"","description":"","width":453,"height":679,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null,"href":""},"dataRefs":{},"dataId":"c1d63","props":{"type":"WPhotoProperties","displayMode":"fill","metaData":{}},"propsId":"WPht1-1ci9"},{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht0-4wp","styleId":"wp2","skin":"wysiwyg.viewer.skins.photo.NoSkinPhoto","layout":{"x":25,"y":80,"width":510,"height":160,"scale":1,"rotationInDegrees":0,"anchors":[{"type":"BOTTOM_PARENT","targetComponent":"SITE_HEADER","locked":true,"distance":25,"topToTop":80,"originalValue":265}]},"data":{"type":"Image","uri":"300a449823eb962ddf8e0b253407a2d4.jpg","title":"","description":"","width":1000,"height":667,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null,"href":""},"dataRefs":{},"dataId":"c1kxz","props":{"type":"WPhotoProperties","displayMode":"fill","metaData":{}},"propsId":"WPht0-4wp"}]';
            window.mobileEditorUIDriver.addComponentsToHeader(componentsToAddStringified, function () {
                window.mobileEditorUIDriver.sleep(500, function () {
                    window.mobileEditorUIDriver.switchToMobileEditor(function () {
                        window.mobileEditorUIDriver.regenerateWholeMobileStructureLayout(function () {
                            window.mobileEditorUIDriver.switchToDesktopEditor();
                        });
                    });
                });
            });
        });

        it('+ simple conversion test - should be correct without any merges', function () {
            window.mobileEditorUIDriver.switchToMobileEditor(function () {
                var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage"],"masterPage":["SITE_FOOTER","SITE_HEADER","WPht0-4wp","WPht1-1ci9","WPht2-j3i","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------WPht0-4wp,&@slashn------WPht1-1ci9,&@slashn------WPht2-j3i,&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:200}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:448,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:218}&@slashn------WPht0-4wp:{x:20,y:70,width:280,height:88}&@slashn------WPht1-1ci9:{x:80,y:168,width:50,height:40}&@slashn------WPht2-j3i:{x:190,y:168,width:50,height:40}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:238,width:320,height:200}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:200}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:238,targetComponent:PAGES_CONTAINER,topToTop:228,type:BOTTOM_TOP}&@slashn]&@slashn------WPht0-4wp:[&@slashn{distance:10,locked:true,originalValue:168,targetComponent:WPht1-1ci9,topToTop:98,type:BOTTOM_TOP}&@slashn{distance:10,locked:true,originalValue:168,targetComponent:WPht2-j3i,topToTop:98,type:BOTTOM_TOP}&@slashn]&@slashn------WPht1-1ci9:[&@slashn{distance:10,locked:true,originalValue:218,targetComponent:SITE_HEADER,topToTop:168,type:BOTTOM_PARENT}&@slashn]&@slashn------WPht2-j3i:[&@slashn{distance:10,locked:true,originalValue:218,targetComponent:SITE_HEADER,topToTop:168,type:BOTTOM_PARENT}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:10,locked:true,originalValue:70,targetComponent:WPht0-4wp,topToTop:60,type:BOTTOM_TOP}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:748,targetComponent:SITE_FOOTER,topToTop:510,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:500,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                window.mobileEditorUIDriver.sleep(500, function () {
                    window.structureComparisonDriver.testPage('masterPage', expectedMobileSiteResults);
                });
            });
        }); //it

        //PASS
        it('+ first component is deleted, header height should not be changed', function () {
            window.mobileEditorUIDriver.deleteComponent("WPht0-4wp");

            window.mobileEditorUIDriver.switchToMobileEditor(function () {
                window.mobileEditorUIDriver.sleep(500, function () {
                    var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage"],"masterPage":["SITE_FOOTER","SITE_HEADER","WPht1-1ci9","WPht2-j3i","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------WPht1-1ci9,&@slashn------WPht2-j3i,&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:200}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:448,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:218}&@slashn------WPht1-1ci9:{x:80,y:70,width:50,height:40}&@slashn------WPht2-j3i:{x:190,y:70,width:50,height:40}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:238,width:320,height:200}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:200}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:238,targetComponent:PAGES_CONTAINER,topToTop:228,type:BOTTOM_TOP}&@slashn]&@slashn------WPht1-1ci9:[&@slashn{distance:108,locked:false,originalValue:218,targetComponent:SITE_HEADER,topToTop:70,type:BOTTOM_PARENT}&@slashn]&@slashn------WPht2-j3i:[&@slashn{distance:108,locked:false,originalValue:218,targetComponent:SITE_HEADER,topToTop:70,type:BOTTOM_PARENT}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:158,locked:false,originalValue:218,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:748,targetComponent:SITE_FOOTER,topToTop:510,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:500,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                    window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);
                });
            });
        }); //it

        //PASS
        it("+ adding two compositions of two components each", function () {
            var componentsToAddStringified = '[{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht2-f1w","styleId":"wp1","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":575,"y":95,"width":166,"height":65,"scale":1,"rotationInDegrees":0,"anchors":[{"type":"TOP_TOP","targetComponent":"WPht3-18hw","locked":true,"distance":10,"topToTop":10,"originalValue":105},{"type":"BOTTOM_TOP","targetComponent":"WPht1-1ci9","locked":true,"distance":40,"topToTop":105,"originalValue":200},{"type":"BOTTOM_TOP","targetComponent":"WPht2-j3i","locked":true,"distance":40,"topToTop":105,"originalValue":200}]},"data":{"type":"Image","uri":"36a890558baa778dce7b6cbc6b746d5a.jpg","title":"","description":"","width":1500,"height":998,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null,"href":""},"dataRefs":{},"dataId":"c16i7","props":{"type":"WPhotoProperties","displayMode":"fill","metaData":{}},"propsId":"c1t7x"},{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht3-18hw","styleId":"wp1","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":565,"y":105,"width":196,"height":45,"scale":1,"rotationInDegrees":0,"anchors":[{"type":"BOTTOM_TOP","targetComponent":"WPht1-1ci9","locked":true,"distance":50,"topToTop":95,"originalValue":200},{"type":"BOTTOM_TOP","targetComponent":"WPht2-j3i","locked":true,"distance":50,"topToTop":95,"originalValue":200},{"type":"BOTTOM_BOTTOM","targetComponent":"WPht2-f1w","locked":true,"distance":10,"topToTop":10,"originalValue":65}]},"data":{"type":"Image","uri":"36a890558baa778dce7b6cbc6b746d5a.jpg","title":"","description":"","width":1500,"height":998,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null,"href":""},"dataRefs":{},"dataId":"c1j6w","props":{"type":"WPhotoProperties","displayMode":"fill","metaData":{}},"propsId":"c1rgw"},{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht4-94v","styleId":"wp1","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":770,"y":180,"width":166,"height":57,"scale":1,"rotationInDegrees":0,"anchors":[{"type":"TOP_TOP","targetComponent":"WPht1-q42","locked":true,"distance":20,"topToTop":20,"originalValue":200},{"type":"BOTTOM_PARENT","targetComponent":"SITE_HEADER","locked":true,"distance":28,"topToTop":180,"originalValue":265}]},"data":{"type":"Image","uri":"7ebf9b24c339b67eb5c86ec71bc30476.jpg","title":"","description":"","width":1500,"height":1000,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null,"href":""},"dataRefs":{},"dataId":"c1k2n","props":{"type":"WPhotoProperties","displayMode":"fill","metaData":{}},"propsId":"c1qwg"},{"componentType":"wysiwyg.viewer.components.WPhoto","type":"Component","id":"WPht1-q42","styleId":"wp1","skin":"wysiwyg.viewer.skins.photo.RoundPhoto","layout":{"x":800,"y":200,"width":166,"height":57,"scale":1,"rotationInDegrees":0,"anchors":[{"type":"BOTTOM_PARENT","targetComponent":"SITE_HEADER","locked":true,"distance":8,"topToTop":200,"originalValue":265}]},"data":{"type":"Image","uri":"7ebf9b24c339b67eb5c86ec71bc30476.jpg","title":"","description":"","width":1500,"height":1000,"metaData":{"isPreset":false},"linkType":"FREE_LINK","alt":"","target":"","originalImageDataRef":null,"href":""},"dataRefs":{},"dataId":"cain","props":{"type":"WPhotoProperties","displayMode":"fill","metaData":{}},"propsId":"c22y3"}]';

            window.mobileEditorUIDriver.addComponentsToContainer(componentsToAddStringified, 'SITE_HEADER', function () {
                window.mobileEditorUIDriver.switchToMobileEditor(function () {
                    window.mobileEditorUIDriver.sleep(500, function () {
                        var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage"],"masterPage":["SITE_FOOTER","SITE_HEADER","WPht0-4wp","WPht1-1ci9","WPht2-j3i","TINY_MENU","WPht2-f1w","WPht3-18hw","WPht4-94v","WPht1-q42","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------WPht0-4wp,&@slashn------WPht1-1ci9,&@slashn------WPht2-j3i,&@slashn------TINY_MENU,&@slashn------WPht2-f1w,&@slashn------WPht3-18hw,&@slashn------WPht4-94v,&@slashn------WPht1-q42&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:200}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:661,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:431}&@slashn------WPht0-4wp:{x:20,y:70,width:280,height:88}&@slashn------WPht1-1ci9:{x:80,y:271,width:50,height:40}&@slashn------WPht2-j3i:{x:190,y:271,width:50,height:40}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn------WPht2-f1w:{x:34,y:168,width:237,height:93}&@slashn------WPht3-18hw:{x:20,y:182,width:280,height:64}&@slashn------WPht4-94v:{x:20,y:321,width:237,height:81}&@slashn------WPht1-q42:{x:63,y:350,width:237,height:81}&@slashn---PAGES_CONTAINER:{x:0,y:451,width:320,height:200}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:200}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:238,targetComponent:PAGES_CONTAINER,topToTop:228,type:BOTTOM_TOP}&@slashn]&@slashn------WPht0-4wp:[&@slashn{distance:10,locked:true,originalValue:168,targetComponent:WPht2-f1w,topToTop:98,type:BOTTOM_TOP}&@slashn]&@slashn------WPht1-1ci9:[&@slashn{distance:10,locked:true,originalValue:321,targetComponent:WPht4-94v,topToTop:50,type:BOTTOM_TOP}&@slashn]&@slashn------WPht2-j3i:[&@slashn{distance:10,locked:true,originalValue:321,targetComponent:WPht4-94v,topToTop:50,type:BOTTOM_TOP}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:10,locked:true,originalValue:70,targetComponent:WPht0-4wp,topToTop:60,type:BOTTOM_TOP}&@slashn]&@slashn------WPht2-f1w:[&@slashn{distance:10,locked:true,originalValue:271,targetComponent:WPht1-1ci9,topToTop:103,type:BOTTOM_TOP}&@slashn{distance:10,locked:true,originalValue:271,targetComponent:WPht2-j3i,topToTop:103,type:BOTTOM_TOP}&@slashn{distance:14,locked:true,originalValue:182,targetComponent:WPht3-18hw,topToTop:14,type:TOP_TOP}&@slashn]&@slashn------WPht3-18hw:[&@slashn{distance:15,locked:true,originalValue:93,targetComponent:WPht2-f1w,topToTop:14,type:BOTTOM_BOTTOM}&@slashn{distance:25,locked:true,originalValue:271,targetComponent:WPht1-1ci9,topToTop:89,type:BOTTOM_TOP}&@slashn{distance:25,locked:true,originalValue:271,targetComponent:WPht2-j3i,topToTop:89,type:BOTTOM_TOP}&@slashn]&@slashn------WPht4-94v:[&@slashn{distance:29,locked:true,originalValue:350,targetComponent:WPht1-q42,topToTop:29,type:TOP_TOP}&@slashn{distance:0,locked:true,originalValue:218,targetComponent:SITE_HEADER,topToTop:321,type:BOTTOM_PARENT}&@slashn]&@slashn------WPht1-q42:[&@slashn{distance:0,locked:true,originalValue:218,targetComponent:SITE_HEADER,topToTop:350,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:748,targetComponent:SITE_FOOTER,topToTop:510,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:500,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                        window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);
                    });
                });
            });
        }); //it

        //PASS
        it('+ top component is hidden, then readded', function () {
            window.mobileEditorUIDriver.switchToMobileEditor(function () {
                window.mobileEditorUIDriver.deleteComponent("WPht0-4wp");

                var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage"],"masterPage":["SITE_FOOTER","SITE_HEADER","WPht1-1ci9","WPht2-j3i","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------WPht1-1ci9,&@slashn------WPht2-j3i,&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:200}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:448,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:218}&@slashn------WPht1-1ci9:{x:80,y:70,width:50,height:40}&@slashn------WPht2-j3i:{x:190,y:70,width:50,height:40}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:238,width:320,height:200}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:200}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:238,targetComponent:PAGES_CONTAINER,topToTop:228,type:BOTTOM_TOP}&@slashn]&@slashn------WPht1-1ci9:[&@slashn{distance:108,locked:false,originalValue:218,targetComponent:SITE_HEADER,topToTop:70,type:BOTTOM_PARENT}&@slashn]&@slashn------WPht2-j3i:[&@slashn{distance:108,locked:false,originalValue:218,targetComponent:SITE_HEADER,topToTop:70,type:BOTTOM_PARENT}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:158,locked:false,originalValue:218,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:748,targetComponent:SITE_FOOTER,topToTop:510,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:500,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);

                window.mobileEditorUIDriver.readdComponentToMasterPage("WPht0-4wp", function () {
                    window.mobileEditorUIDriver.sleep(1000, function () {
                        var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage"],"masterPage":["SITE_FOOTER","SITE_HEADER","WPht1-1ci9","WPht2-j3i","TINY_MENU","WPht0-4wp","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------WPht1-1ci9,&@slashn------WPht2-j3i,&@slashn------TINY_MENU,&@slashn------WPht0-4wp&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:200}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:448,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:218}&@slashn------WPht1-1ci9:{x:80,y:168,width:50,height:40}&@slashn------WPht2-j3i:{x:190,y:168,width:50,height:40}&@slashn------TINY_MENU:{x:250,y:108,width:50,height:50}&@slashn------WPht0-4wp:{x:20,y:10,width:280,height:88}&@slashn---PAGES_CONTAINER:{x:0,y:238,width:320,height:200}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:200}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:238,targetComponent:PAGES_CONTAINER,topToTop:228,type:BOTTOM_TOP}&@slashn]&@slashn------WPht1-1ci9:[&@slashn{distance:10,locked:true,originalValue:218,targetComponent:SITE_HEADER,topToTop:168,type:BOTTOM_PARENT}&@slashn]&@slashn------WPht2-j3i:[&@slashn{distance:10,locked:true,originalValue:218,targetComponent:SITE_HEADER,topToTop:168,type:BOTTOM_PARENT}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:60,locked:true,originalValue:218,targetComponent:SITE_HEADER,topToTop:108,type:BOTTOM_PARENT}&@slashn]&@slashn------WPht0-4wp:[&@slashn{distance:70,locked:true,originalValue:168,targetComponent:WPht1-1ci9,topToTop:158,type:BOTTOM_TOP}&@slashn{distance:70,locked:true,originalValue:168,targetComponent:WPht2-j3i,topToTop:158,type:BOTTOM_TOP}&@slashn{distance:10,locked:true,originalValue:108,targetComponent:TINY_MENU,topToTop:98,type:BOTTOM_TOP}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:748,targetComponent:SITE_FOOTER,topToTop:510,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:500,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                        window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);
                    });
                });
            });
        }); //it

        //PASS
        it('+ deleting components in desktop from the header shrinks the header', function () {
            window.mobileEditorUIDriver.deleteComponent("WPht1-1ci9");
            window.mobileEditorUIDriver.deleteComponent("WPht2-j3i");
            window.mobileEditorUIDriver.switchToMobileEditor(function () {
                var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage"],"masterPage":["SITE_FOOTER","SITE_HEADER","WPht1-1ci9","WPht2-j3i","TINY_MENU","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER:{&@slashn------WPht1-1ci9,&@slashn------WPht2-j3i,&@slashn------TINY_MENU&@slashn---}&@slashn,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:200}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:448,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:218}&@slashn------WPht1-1ci9:{x:80,y:70,width:50,height:40}&@slashn------WPht2-j3i:{x:190,y:70,width:50,height:40}&@slashn------TINY_MENU:{x:250,y:10,width:50,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:238,width:320,height:200}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:200}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:238,targetComponent:PAGES_CONTAINER,topToTop:228,type:BOTTOM_TOP}&@slashn]&@slashn------WPht1-1ci9:[&@slashn{distance:108,locked:false,originalValue:218,targetComponent:SITE_HEADER,topToTop:70,type:BOTTOM_PARENT}&@slashn]&@slashn------WPht2-j3i:[&@slashn{distance:108,locked:false,originalValue:218,targetComponent:SITE_HEADER,topToTop:70,type:BOTTOM_PARENT}&@slashn]&@slashn------TINY_MENU:[&@slashn{distance:158,locked:false,originalValue:218,targetComponent:SITE_HEADER,topToTop:10,type:BOTTOM_PARENT}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:748,targetComponent:SITE_FOOTER,topToTop:510,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:500,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);

            });

        }); //it

        //PASS
        it('+ deleting components in desktop from the header which leaves it empty, keeps it with 50px', function () {
            window.mobileEditorUIDriver.switchToMobileEditor(function () {
                window.mobileEditorUIDriver.deleteComponent("TINY_MENU");
                window.mobileEditorUIDriver.switchToDesktopEditor();
                window.mobileEditorUIDriver.deleteComponent("WPht1-1ci9");
                window.mobileEditorUIDriver.deleteComponent("WPht2-j3i");
                window.mobileEditorUIDriver.deleteComponent("WPht0-4wp");
                window.mobileEditorUIDriver.switchToMobileEditor(function () {
                    window.mobileEditorUIDriver.sleep(1000, function () {
                        var expectedMobileSiteResults = '{"pageToComponentIdList":{"mainPage":["mainPage"],"masterPage":["SITE_FOOTER","SITE_HEADER","PAGES_CONTAINER","SITE_PAGES"]},"pageToStructureSkeleton":{"mainPage":"mainPage","masterPage":"ROOT:{&@slashn---SITE_FOOTER,&@slashn---SITE_HEADER,&@slashn---PAGES_CONTAINER:{&@slashn------SITE_PAGES&@slashn---}&@slashn&@slashn}&@slashn"},"pageToLayoutDetails":{"mainPage":"mainPage:{x:0,y:0,width:320,height:200}&@slashn","masterPage":"---SITE_FOOTER:{x:0,y:280,width:320,height:78}&@slashn---SITE_HEADER:{x:0,y:10,width:320,height:50}&@slashn---PAGES_CONTAINER:{x:0,y:70,width:320,height:200}&@slashn------SITE_PAGES:{x:0,y:0,width:320,height:200}&@slashn"},"pageToAnchors":{"mainPage":"mainPage:[&@slashn]&@slashn","masterPage":"---SITE_FOOTER:[&@slashn{distance:10,locked:true,originalValue:500,targetComponent:SITE_STRUCTURE,topToTop:500,type:BOTTOM_PARENT}&@slashn]&@slashn---SITE_HEADER:[&@slashn{distance:10,locked:true,originalValue:238,targetComponent:PAGES_CONTAINER,topToTop:228,type:BOTTOM_TOP}&@slashn]&@slashn---PAGES_CONTAINER:[&@slashn{distance:10,locked:true,originalValue:748,targetComponent:SITE_FOOTER,topToTop:510,type:BOTTOM_TOP}&@slashn]&@slashn------SITE_PAGES:[&@slashn{distance:0,locked:true,originalValue:500,targetComponent:PAGES_CONTAINER,topToTop:0,type:BOTTOM_PARENT}&@slashn]&@slashn"}}';
                        window.structureComparisonDriver.testPage('mainPage', expectedMobileSiteResults);

                    });
                });
            });
        }); //it


    }); // describe masterPage sanity

});

//SOLVED BUGS:
//MOB-1024
//MOB-1017
//MOB-1030
//MOB-1020
//MOB-1023
//MOB-1011
//MOB-1010
//MOB-1012
//MOb-680
//(consider MOb-680 as an improvement for that feature - 'when several existing components are attached to the new container, they should be together in the mobileEditor'
